(self.webpackChunk_wixc3_component_playground=self.webpackChunk_wixc3_component_playground||[]).push([[9772],{18535:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeViewsSetMod=t.CodeViewsRemoveMod=t.CodeViewsCreateMod=void 0,t.CodeViewsCreateMod="CodeViewsCreate",t.CodeViewsRemoveMod="CodeViewsRemove",t.CodeViewsSetMod="CodeViewsSet"},71624:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(5163);s.__exportStar(i(98191),t),s.__exportStar(i(18535),t),s.__exportStar(i(82657),t)},98191:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},82657:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showAccessPath=t.isSimpleConstantSchema=t.findMatchingSignature=t.isSchemaMatchingNodeKind=t.createAstNodeFromValue=void 0,t.createAstNodeFromValue=(e,t)=>{const i=e();return null===t?{kind:"null",astNodeId:i}:void 0===t?{kind:"undefined",astNodeId:i}:{kind:typeof t,astNodeId:i,value:t}},t.isSchemaMatchingNodeKind=(e,i,s)=>(null==e?void 0:e.$ref)&&s?(0,t.isSchemaMatchingNodeKind)(s[e.$ref],i,s):(null==e?void 0:e.type)?i===("common/interface"===e.type?"object":"common/enumvalue"===e.type?"property-access":"common/undefined"===e.type||"common/null"===e.type?e.type.split("/").pop():e.type):!!(null==e?void 0:e.oneOf)&&e.oneOf.some((e=>(0,t.isSchemaMatchingNodeKind)(e,i,s))),t.findMatchingSignature=function(e,i,s){var n,o,r;if(!e||!(null==i?void 0:i.signatures)||0===i.signatures.length)return;if(1===i.signatures.length)return i.signatures[0];const a=Array(i.signatures.length).fill(0);for(let r=0;r<e.args.length;r++){const l=e.args[r];for(let e=0;e<i.signatures.length;e++){const p=i.signatures[e],u=(0,t.isSchemaMatchingNodeKind)(null===(n=p.arguments)||void 0===n?void 0:n[r],l.kind,s),c=p.arguments&&r>=p.arguments.length&&(0,t.isSchemaMatchingNodeKind)(null===(o=p.restArgument)||void 0===o?void 0:o.items,l.kind,s);(u||c)&&a[e]++}}let l=0;for(let t=0;t<i.signatures.length;t++){const s=a[t];if(s===e.args.length&&s===(null===(r=i.signatures[t].arguments)||void 0===r?void 0:r.length))return i.signatures[t];l=s>a[l]?t:l}return i.signatures[l]},t.isSimpleConstantSchema=function(e){return!e.definedAt&&(null==e?void 0:e.enum)&&1===(null==e?void 0:e.enum.length)},t.showAccessPath=function(e){return e.map((e=>`['${e}']`)).join("")}},9576:(e,t,i)=>{e.exports=i(71624)},11320:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.demoAstParsers=void 0;const s=i(26709),n=i(9240);t.demoAstParsers=[...n.commonSimpleAstParsers,s.demoPlugin].map((e=>e.nodeKind))},4601:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(5163);s.__exportStar(i(73676),t),s.__exportStar(i(11320),t),s.__exportStar(i(59114),t)},73676:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simulationAstParsers=void 0;const s=i(26709),n=i(9240),o=i(30802);t.simulationAstParsers=[...n.commonSimpleAstParsers,o.simulationPlugin,s.demoPlugin].map((e=>e.nodeKind))},59114:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},51321:(e,t,i)=>{e.exports=i(4601)},16500:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(5163),n=i(93849),o=s.__importStar(i(2206)),r=s.__importDefault(i(91821)),a=s.__importDefault(i(94400)),l=s.__importDefault(i(89111)),p=s.__importDefault(i(65502)),u=i(5689);t.default=new n.Feature({id:"simulationSuggestions",dependencies:[o.default.asEntity,r.default.asEntity,a.default.asEntity,l.default.asEntity,p.default.asEntity],api:{simulationSuggestionsService:n.Service.withType().defineEntity(o.processingEnv).allowRemoteAccess(),createSimulationSuggestionsApi:n.Service.withType().defineEntity(u.mainEnv)}})},67962:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(5163),n=i(2206),o=s.__importDefault(i(16500)),r=i(75892);o.default.setup(n.processingEnv,(({},{simpleAST:{simpleAST:e,idService:t,simpleASTPluginRepo:i},typescript:{languageIntellisense:s}})=>({simulationSuggestionsService:new r.SimulationSuggestionsService(e,t,i,s)})))},75892:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(5163).__exportStar(i(76907),t)},76907:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulationSuggestionsServiceHelper=t.SimulationSuggestionsService=void 0;const s=i(5163).__importDefault(i(60270)),n=i(51321),o=i(98066),r=i(66286);t.SimulationSuggestionsService=class{constructor(e,t,i,s){this.simpleAstManager=e,this.idService=t,this.simpleASTPluginRepo=i,this.languageIntellisense=s}getSimulationPropsMap(e){return new a(this.simpleAstManager,this.idService,this.simpleASTPluginRepo,this.languageIntellisense,e).getSimulationPropsMap()}getSuggestions(e){return new a(this.simpleAstManager,this.idService,this.simpleASTPluginRepo,this.languageIntellisense,e).getSuggestions(e.path,e.propName)}};class a{constructor(e,t,i,s,n){this.simpleAstManager=e,this.idService=t,this.simpleASTPluginRepo=i,this.languageIntellisense=s,this.simulationId=n;const o=n.filePath;this.api=this.idService.getFileAPI(o),this.lang=this.languageIntellisense.getLanguageController(o);const r=this.lang.languageService.getProgram();if(!r)throw new Error(`Failed to create program in ${n.filePath}`);this.program=r;const a=this.program.getSourceFile(o);if(!a)throw new Error(`Failed to create sourceFile in ${n.filePath}`);this.sourceFile=a,this.typeChecker=r.getTypeChecker()}getSimulationArgumentTSNode(){const e=this.simpleAstManager.get({filePath:this.simulationId.filePath,parsers:n.simulationAstParsers}),t=(0,o.getSimulationNode)(e);if(!t)throw new Error(`Failed to find simulation to copy in ${this.simulationId.filePath}`);return function(e,t){let i=s.default.getTokenAtPosition(t,e.pos);for(;i.parent&&i.parent.pos===e.pos&&i.end<e.end;)i=i.parent;return i}(this.api.getNodeByID(t.data.astNodeId),this.sourceFile)}getExpectedPropsType(e){let t=this.typeChecker.getAnyType();const i=this.typeChecker.getContextualType(e);if(i){const e=(0,r.getTypeArguments)(i);if(e&&e.length){const i=(0,r.getTypeArguments)(e[0]);if(i&&i.length>1){const e=(0,r.getTypeArguments)(i[1]);t=e&&e.length?e[0]:i[0]}}}return t}getSimulationPropsMap(){const e=this.getSimulationArgumentTSNode(),t=this.getExpectedPropsType(e),i={};t.getProperties().forEach((e=>{const s=this.typeChecker.getTypeOfPropertyOfType(t,e.name);if(!s)throw new Error(`Failed to get expected prop type for ${e.name} in ${this.simulationId.filePath}`);const n=this.typeChecker.isTypeAssignableTo(this.typeChecker.getUndefinedType(),s);i[e.name]={expected:s,valid:n}}));const s=this.typeChecker.getTypeAtLocation(e),n=this.typeChecker.getTypeOfPropertyOfType(s,"props");if(!n)throw new Error(`Failed to get actual props type in ${this.simulationId.filePath}`);return n.getProperties().forEach((e=>{i[e.name]||(i[e.name]={valid:!1});const t=this.typeChecker.getTypeOfPropertyOfType(n,e.name);if(!t)throw new Error(`Failed to get actual prop type for ${e.name} in ${this.simulationId.filePath}`);i[e.name].actual=t;const s=i[e.name].expected;if(s){const n=this.typeChecker.isTypeAssignableTo(t,s);i[e.name].valid=n}})),i}getExpectedTypesMap(e,t){const i=this.getSimulationArgumentTSNode();let n=this.getExpectedPropsType(i);const o=new Map;if(e){let t=e,i=n;for(;t.length;)if(i.flags&s.default.TypeFlags.Object){const e=t[0],s=i.getProperties().find((t=>t.name===e));if(!s)break;{const e=this.typeChecker.getTypeOfPropertyOfType(i,s.name);if(!e)break;i=e}t=t.slice(1)}if(t.length)return o;n=i}return n.getProperties().forEach((e=>{if(!t||e.name===t){const t=this.typeChecker.getTypeOfPropertyOfType(n,e.name);if(!t)throw new Error(`Failed to get expected prop type for ${e.name} in ${this.simulationId.filePath}`);o.set(e.name,t)}})),o}getSuggestions(e,t){const i=this.getExpectedTypesMap(e,t),s=new Set([...i.values()].filter(r.isUsableType)),n=(0,r.getSuggestionsForAllExpectedTypes)(this.simpleAstManager,this.idService,this.simpleASTPluginRepo,this.languageIntellisense,this.simulationId,s),o=[];for(const[e,t]of i)if(t){const i=n.get(t);i&&i.forEach((({varNode:t,sourceAccessPath:i})=>{o.push({fileName:this.simulationId.filePath,propName:e,varNode:t,sourceAccessPath:i})}))}return o}}t.SimulationSuggestionsServiceHelper=a},66286:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSuggestionsForAllExpectedTypes=t.findAssignableValuesInAstForAllExpectedTypes=t.findAssignableValuesInTypeForAllExpectedTypes=t.findAssignableValuesInAst=t.findAssignableValuesInType=t.getTypeArguments=t.isUsableType=t.getCorrespondingNodeFromSourceFile=void 0;const s=i(5163).__importDefault(i(60270)),n=i(9240),o=i(51321),r=i(98066),a=i(9576);function l(e,t){let i=s.default.getTokenAtPosition(t,e.pos);for(;i.parent&&i.parent.pos===e.pos&&i.end<e.end;)i=i.parent;return i}function p(e,t,i){e.isTypeAssignableTo&&function i(n,o){((i,n)=>{if(i&&"error"!==i.intrinsicName&&"any"!==i.intrinsicName)for(const[o,r]of t)i.symbol&&i.symbol.flags&s.default.SymbolFlags.Method||e.isTypeAssignableTo(i,o)&&r.set((0,a.showAccessPath)(n),{path:n})})(n,o),n.flags&s.default.TypeFlags.Object&&n.getProperties().forEach((t=>{const s=e.getTypeOfPropertyOfType(n,t.name);if(s){const e=t.name;i(s,[...o,e])}}))}(i,[])}function u(e,t,i){e.isTypeAssignableTo&&function i(n,o){((i,n)=>{const o=e.getTypeAtLocation(i);if(o&&"error"!==o.intrinsicName&&"any"!==o.intrinsicName)for(const[i,r]of t)o.symbol&&o.symbol.flags&s.default.SymbolFlags.Method||e.isTypeAssignableTo(o,i)&&r.set((0,a.showAccessPath)(n),{path:n})})(n,o),s.default.isArrayLiteralExpression(n)?n.elements.map(((e,t)=>{i(e,[...o,`${t}`])})):s.default.isObjectLiteralExpression(n)?n.properties.map((e=>{s.default.isPropertyAssignment(e)&&(s.default.isIdentifier(e.name)||s.default.isStringLiteral(e.name))&&i(e.initializer,[...o,e.name.text])})):s.default.isAsExpression(n)&&i(n.expression,o)}(i,[])}t.getCorrespondingNodeFromSourceFile=l,t.isUsableType=function(e){return e&&"error"!==e.intrinsicName&&"any"!==e.intrinsicName},t.getTypeArguments=function(e){return e.typeArguments||e.aliasTypeArguments},t.findAssignableValuesInType=function(e,t,i){const n=new Map;return e.isTypeAssignableTo?(function i(o,r){((i,o)=>{i&&"error"!==i.intrinsicName&&"any"!==i.intrinsicName&&e.isTypeAssignableTo(i,t)&&(i.symbol&&i.symbol.flags&s.default.SymbolFlags.Method||n.set((0,a.showAccessPath)(o),o))})(o,r),o.flags&s.default.TypeFlags.Object&&o.getProperties().forEach((t=>{const s=e.getTypeOfPropertyOfType(o,t.name);if(s){const e=t.name;i(s,[...r,e])}}))}(i,[]),n):n},t.findAssignableValuesInAst=function(e,t,i){const n=new Map;return e.isTypeAssignableTo?(function i(o,r){((i,s)=>{const o=e.getTypeAtLocation(i);o&&"error"!==o.intrinsicName&&"any"!==o.intrinsicName&&e.isTypeAssignableTo(o,t)&&n.set((0,a.showAccessPath)(s),s)})(o,r),s.default.isArrayLiteralExpression(o)?o.elements.map(((e,t)=>{i(e,[...r,`${t}`])})):s.default.isObjectLiteralExpression(o)?o.properties.map((e=>{s.default.isPropertyAssignment(e)&&(s.default.isIdentifier(e.name)||s.default.isStringLiteral(e.name))&&i(e.initializer,[...r,e.name.text])})):s.default.isAsExpression(o)&&i(o.expression,r)}(i,[]),n):n},t.findAssignableValuesInTypeForAllExpectedTypes=p,t.findAssignableValuesInAstForAllExpectedTypes=u,t.getSuggestionsForAllExpectedTypes=function(e,t,i,a,c,g){const d=c.filePath,f=t.getFileAPI(d),m=a.getLanguageController(d).languageService.getProgram();if(!m)throw new Error(`Failed to create program in ${c.filePath}`);const h=m.getSourceFile(d);if(!h)throw new Error(`Failed to create sourceFile in ${c.filePath}`);const y=m.getTypeChecker(),S=f.getSourceFile(),A=f.getUnderlyingIDService(),T=e.get({filePath:c.filePath,parsers:o.simulationAstParsers}),P=T.getLatest(),v=(0,r.getSimulationNode)(T);if(!v)throw new Error(`Failed to find simulation to copy in ${c.filePath}`);const _=l(f.getNodeByID(v.astNodeId),h),b=new Map;for(const e of g)b.set(e,[]);const w=new Map;y.getSymbolsInScope(_,s.default.SymbolFlags.BlockScopedVariable).forEach((e=>{var t,o;const r=null!==(t=e.valueDeclaration)&&void 0!==t?t:null===(o=e.exportSymbol)||void 0===o?void 0:o.valueDeclaration;if(!r)return;if(!s.default.isVariableDeclaration(r)||!r.initializer)return;if(r.pos>_.pos)return;const a=y.getTypeAtLocation(r);if(!a||"error"===a.intrinsicName||a===y.getAnyType())return;const c=l(r,S),d=A.nodesToIds.get(c);if(d){const e=(0,n.findNodeAndParents)(P,d,i.getPlugins());if(e&&(0,n.isVariableNode)(e.node)){const t=e.node,i=new Map;for(const e of g)i.has(e)||i.set(e,new Map);u(y,i,r.initializer),p(y,i,a),w.set(t,i)}}}));for(const[e,t]of w)for(const[i,s]of t)for(const t of s.values()){const s=b.get(i);s&&s.push({varNode:e,sourceAccessPath:t.path})}return b}}}]);