(self.webpackChunk_wixc3_component_playground=self.webpackChunk_wixc3_component_playground||[]).push([[8659],{71920:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMetadata=void 0,t.createMetadata=function(e){return e}},14716:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderableBase=t.baseRender=void 0;const o=i(71920),n=i(78530),a=i(16846);t.baseRender=async function(e,t,i){(0,a.callHooks)(e,"beforeRender",i),await t(i),(0,a.callHooks)(e,"afterRender",i)},t.createRenderableBase=function(e){return(0,o.createMetadata)(Object.assign(Object.assign({},e),{setupStage(e=document.body){return(0,n.setupBoardStage)(this,e)}}))}},16846:(e,t)=>{"use strict";function i(e,t){return e.plugins?e.plugins.filter((e=>!!e.key.plugin[t])):[]}Object.defineProperty(t,"__esModule",{value:!0}),t.callHooks=t.getPluginsWithHooks=void 0,t.getPluginsWithHooks=i,t.callHooks=function(e,t,...o){const n=i(e,t);for(const e of n)e.key.plugin[t]&&e.key.plugin[t](e.props,...o)}},50210:function(e,t,i){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,i,o){void 0===o&&(o=i),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,o){void 0===o&&(o=i),e[o]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||o(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(71920),t),n(i(14716),t),n(i(78530),t),n(i(16846),t),n(i(19961),t)},78530:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupBoardStage=t.defaultEnvironmentProperties=t.defaultCanvasStyles=t.defaultWindowStyles=void 0;const o=i(16846);t.defaultWindowStyles={width:1024,height:640,backgroundColor:"#fcfcfc"},t.defaultCanvasStyles={width:"fit-content",height:"fit-content",marginLeft:"auto",marginRight:"auto",marginBottom:"auto",marginTop:"auto",paddingLeft:"0px",paddingRight:"0px",paddingBottom:"0px",paddingTop:"0px",backgroundColor:"#fff"},t.defaultEnvironmentProperties={windowWidth:t.defaultWindowStyles.width,windowHeight:t.defaultWindowStyles.height,windowBackgroundColor:t.defaultWindowStyles.backgroundColor,canvasMargin:{},canvasPadding:{},canvasBackgroundColor:t.defaultCanvasStyles.backgroundColor};const n=(e={},i)=>{i.windowHeight=i.windowHeight?window.outerHeight:t.defaultWindowStyles.height,i.windowWidth=i.windowWidth?window.outerWidth:t.defaultWindowStyles.width,i.windowBackgroundColor=i.windowBackgroundColor?document.body.style.backgroundColor:t.defaultWindowStyles.backgroundColor,window.resizeTo(e.windowWidth||i.windowWidth,e.windowHeight||i.windowHeight),document.body.style.backgroundColor=e.windowBackgroundColor||i.windowBackgroundColor},a=(e,i={})=>{var o,n,a,s,r,d,u,l,c,m,g,p,v,h,f,b,S,P;const w={width:i.canvasWidth?`${i.canvasWidth}px`:t.defaultCanvasStyles.width,height:i.canvasHeight?`${i.canvasHeight}px`:t.defaultCanvasStyles.height,marginLeft:(null===(o=i.canvasMargin)||void 0===o?void 0:o.left)?`${null===(n=i.canvasMargin)||void 0===n?void 0:n.left}px`:t.defaultCanvasStyles.marginLeft,marginRight:(null===(a=i.canvasMargin)||void 0===a?void 0:a.right)?`${null===(s=i.canvasMargin)||void 0===s?void 0:s.right}px`:t.defaultCanvasStyles.marginRight,marginBottom:(null===(r=i.canvasMargin)||void 0===r?void 0:r.bottom)?`${null===(d=i.canvasMargin)||void 0===d?void 0:d.bottom}px`:t.defaultCanvasStyles.marginBottom,marginTop:(null===(u=i.canvasMargin)||void 0===u?void 0:u.top)?`${null===(l=i.canvasMargin)||void 0===l?void 0:l.top}px`:t.defaultCanvasStyles.marginTop,paddingLeft:(null===(c=i.canvasPadding)||void 0===c?void 0:c.left)?`${null===(m=i.canvasPadding)||void 0===m?void 0:m.left}px`:t.defaultCanvasStyles.paddingLeft,paddingRight:(null===(g=i.canvasPadding)||void 0===g?void 0:g.right)?`${null===(p=i.canvasPadding)||void 0===p?void 0:p.right}px`:t.defaultCanvasStyles.paddingRight,paddingBottom:(null===(v=i.canvasPadding)||void 0===v?void 0:v.bottom)?`${null===(h=i.canvasPadding)||void 0===h?void 0:h.bottom}px`:t.defaultCanvasStyles.paddingBottom,paddingTop:(null===(f=i.canvasPadding)||void 0===f?void 0:f.top)?`${null===(b=i.canvasPadding)||void 0===b?void 0:b.top}px`:t.defaultCanvasStyles.paddingTop,backgroundColor:i.canvasBackgroundColor||t.defaultCanvasStyles.backgroundColor};void 0!==(null===(S=i.canvasMargin)||void 0===S?void 0:S.left)&&void 0!==i.canvasMargin.right&&(w.width="100%"),void 0!==(null===(P=i.canvasMargin)||void 0===P?void 0:P.top)&&void 0!==i.canvasMargin.bottom&&(w.height="auto"),Object.assign(e.style,w)};t.setupBoardStage=(e,t)=>{const i={},s=document.createElement("div");s.setAttribute("id","board-canvas");const{environmentProps:r}=e;return n(r,i),a(s,r),(0,o.callHooks)(e,"beforeAppendCanvas",s),t.appendChild(s),{canvas:s,updateCanvas:e=>{a(s,e)},updateWindow:e=>{n(e,i)},cleanup:()=>{(0,o.callHooks)(e,"beforeStageCleanUp",s),s.remove(),i.windowWidth&&i.windowHeight&&window.resizeTo(i.windowWidth,i.windowHeight),i.windowBackgroundColor&&(document.body.style.backgroundColor=i.windowBackgroundColor)}}}},19961:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPlugin=t.defaultMerge=void 0,t.defaultMerge=e=>[e.reduceRight(((e,t)=>Object.assign(Object.assign({},e),t)))],t.createPlugin=()=>(e,i,o,n=t.defaultMerge)=>{const a={pluginName:e,defaultProps:i,plugin:o,use:e=>({key:a,props:Object.assign(Object.assign({},i),e)}),merge:n};return a}},11320:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.demoAstParsers=void 0;const o=i(26709),n=i(9240);t.demoAstParsers=[...n.commonSimpleAstParsers,o.demoPlugin].map((e=>e.nodeKind))},4601:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163);o.__exportStar(i(73676),t),o.__exportStar(i(11320),t),o.__exportStar(i(59114),t)},73676:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simulationAstParsers=void 0;const o=i(26709),n=i(9240),a=i(30802);t.simulationAstParsers=[...n.commonSimpleAstParsers,a.simulationPlugin,o.demoPlugin].map((e=>e.nodeKind))},59114:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},51321:(e,t,i)=>{e.exports=i(4601)},26393:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSimulationName=t.useSimWindowSize=t.useSimulationIdFromList=t.useComponentSims=t.useSimManager=void 0;const o=i(87363),n=i(27941),a=i(3092),s=i(50210);t.useSimManager=(e,t)=>{const[i,n]=(0,o.useState)();return(0,o.useEffect)((()=>{if(n(void 0),!t)return;let i,o=!1;const a=()=>{o=!0,i&&i.dispose()};return(async()=>{i=await e.getSimulation(t),o?a():n(i)})().catch((()=>{})),a}),[null==t?void 0:t.filePath]),i},t.useComponentSims=(e,t,i=!0)=>{const s=(0,n.useResourceValue)({resourceManager:e.getSimulationListManager(),resourceId:(0,o.useMemo)((()=>(0,a.getComponentRefObject)(t)),[t]),enabled:i});return(0,o.useMemo)((()=>null==s?void 0:s.sort(((e,t)=>(0,a.compareDemoNames)(e.name,t.name)))),[s])},t.useSimulationIdFromList=(e,t)=>{const i=(0,o.useMemo)((()=>{var i,o;if(e)return t?null===(o=e.find((e=>e.id.filePath===t)))||void 0===o?void 0:o.id:null===(i=e[0])||void 0===i?void 0:i.id}),[e,t]);return(0,o.useMemo)((()=>i),[null==i?void 0:i.filePath,null==i?void 0:i.componentTypeRef])},t.useSimWindowSize=e=>{const[t,i]=(0,o.useState)(s.defaultEnvironmentProperties.windowWidth),[n,a]=(0,o.useState)(s.defaultEnvironmentProperties.windowHeight);return(0,o.useEffect)((()=>{if(!e)return;const t=e=>{var t,o;i(null!==(t=e.windowWidth)&&void 0!==t?t:s.defaultEnvironmentProperties.windowWidth),a(null!==(o=e.windowHeight)&&void 0!==o?o:s.defaultEnvironmentProperties.windowHeight)};return e.subscribeToEnvProps(t),()=>e.unsubscribeFromEnvProps(t)}),[e]),{width:t,height:n}},t.useSimulationName=(e,i)=>{const n=(0,t.useSimManager)(e,i),[a,s]=(0,o.useState)(null==n?void 0:n.getSimulationName());return(0,o.useEffect)((()=>{const e=e=>s(e);return null==n||n.subscribeToSimulationName(e),()=>null==n?void 0:n.unsubscribeFromSimulationName(e)}),[n]),a}},28659:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163);o.__exportStar(i(26393),t),o.__exportStar(i(24219),t),o.__exportStar(i(66593),t)},24219:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPropErrorFromDiagnostics=void 0,t.getPropErrorFromDiagnostics=e=>{let t,i;if(e)for(const o of e)o.messageText.includes(" is not assignable to type ")?(t="type-mismatch",i=o.messageText):t||(t="other",i=o.messageText);return{semanticErrorType:t,semanticErrorMessage:i}}},66593:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163);o.__exportStar(i(40864),t),o.__exportStar(i(17839),t)},40864:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulationManager=void 0;const o=i(3092),n=i(91570),a=i(9240),s=i(51321);t.SimulationManager=class{constructor(e,t,i,o,a){this.demoId=e,this.fileManager=t,this.envPropsResource=i,this.astResource=o,this.idGenerator=a,this.envPropsSubscriber=(0,n.setupSubscribers)(),this.simulationNameSubscriber=(0,n.setupSubscribers)(),this.notifyEnvProps=()=>this.envPropsSubscriber.internals.notify(this.envPropsResource.getLatest()),this.notifySimulationNameChange=()=>{const e=this.getSimulationName();e!==this.simulationName&&(this.simulationNameSubscriber.internals.notify(e),this.simulationName=e)},this.simulationName=this.getSimulationName();const s=this.getDemoId(),[r]=s.componentTypeRef.split("#");this.fileManager.get(r,this),this.envPropsResource.subscribe(this.notifyEnvProps),this.astResource.subscribe(this.notifySimulationNameChange)}static async create(e,t,i,o,n){return new this(e,t,await i.getReady(e.filePath,this),await o.getReady({filePath:e.filePath,parsers:s.simulationAstParsers},this),n)}dispose(){const e=this.getDemoId(),[t]=e.componentTypeRef.split("#");this.fileManager.get(t).release(this),this.envPropsResource.release(this),this.envPropsResource.unsubscribe(this.notifyEnvProps),this.astResource.release(this.notifySimulationNameChange)}getDemoId(){return this.demoId}getSimulationName(){const e=(0,o.getDemoNode)(this.astResource);return e?e.name.value:"Simulation"}getSimulationPath(){return this.getDemoId().filePath}subscribeToEnvProps(e){this.envPropsSubscriber.subscribe(e),e(this.envPropsResource.getLatest())}unsubscribeFromEnvProps(e){this.envPropsSubscriber.unsubscribe(e)}subscribeToSimulationName(e){this.simulationNameSubscriber.subscribe(e),e(this.getSimulationName())}unsubscribeFromSimulationName(e){this.simulationNameSubscriber.unsubscribe(e)}getEnvironmentProps(){return this.envPropsResource.getLatest()}getSimNode(){return(0,o.getSimulationNode)(this.astResource)}getEnvironmentPropsNode(){const e=(0,o.getSimulationNode)(this.astResource);if(!e)throw new Error("Can't locate simulation node");return(0,a.getSimpleObjectProp)(e.data.properties,"environmentProps")}patchEnvProps(e){const t=(0,o.getDemoNode)(this.astResource);if(!t)throw new Error("Can't locate demo node");const i=()=>this.idGenerator.generateId(this.getSimulationPath()),n=t.environmentProps||this.createEnvironmentProps(this.astResource,t,i);this.generateObjectPropsModifications(e,n,i).forEach((({modKind:e,modArgs:t,targetNode:i})=>{this.astResource.applyModification(null!=i?i:n,e,t)}))}generateObjectPropsModifications(e,t,i){const o=[];for(const n in e){const s=(0,a.getSimpleObjectProp)(t.properties,n),r=this.generatePropModification(n,e[n],i,s);o.push(...r)}return o}createEnvironmentProps(e,t,i){const n=(0,a.createStringNode)({astNodeId:i(),value:"environmentProps"}),s=a.objectPlugin.createBlank(i);e.applyModification(t,"addEnvironmentProps",{name:n,value:s});const r=(0,o.getDemoNode)(e);if(!(null==r?void 0:r.environmentProps))throw new Error("Failed to create environment props");return r.environmentProps}generatePropModification(e,t,i,o){if("number"==typeof t)return o?[{modKind:"setProperty",modArgs:{childId:o.astNodeId,value:(0,a.createNumberNode)({astNodeId:i(),value:t})}}]:[{modKind:"addProperty",modArgs:{name:(0,a.createStringNode)({astNodeId:i(),value:e}),value:(0,a.createNumberNode)({astNodeId:i(),value:t}),propertyId:i()}}];if("object"==typeof t){const n=[];for(const e in t){const s=o&&(0,a.isObjectNode)(o.initializer)?(0,a.getSimpleObjectProp)(o.initializer.properties,e):void 0,r=this.generatePropModification(e,t[e],i,s);n.push(...r)}if(o)return n.forEach((e=>{e.targetNode||(e.targetNode=o.initializer)})),n;{let t=a.objectPlugin.createBlank(i);return n.forEach((({modKind:e,modArgs:i})=>{"addProperty"===e&&(t=a.objectPlugin.modifiers.addProperty(t,i))})),[{modKind:"addProperty",modArgs:{name:(0,a.createStringNode)({astNodeId:i(),value:e}),value:t,propertyId:i()}}]}}return[]}}},17839:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulationService=void 0;const o=i(40864),n=i(3092);t.SimulationService=class{constructor(e,t,i,o,n,a){this.simulationListManager=e,this.simulationProcessingService=t,this.fileManager=i,this.envPropsManager=o,this.astManager=n,this.idGenerator=a}async createSimulation(e,t,i){await Promise.all([this.waitForSimulationListUpdate(e),this.simulationProcessingService.createDemo(t,i,e)])}async deleteSimulation(e,t){const i=await this.getSimulationId(e,t);i&&await Promise.all([this.waitForSimulationListUpdate(e),this.simulationProcessingService.deleteSimulations([i])])}async deleteSimulations(e){return await this.simulationProcessingService.deleteSimulations(e)}getSimulation(e){return o.SimulationManager.create(e,this.fileManager,this.envPropsManager,this.astManager,this.idGenerator)}async getSimulationList(e){const t=await this.simulationListManager.getReady((0,n.getComponentRefObject)(e));return t.isValid()?t.getLatest():[]}async copySimulation(e,t,i){await Promise.all([this.waitForSimulationListUpdate(e.componentTypeRef),this.simulationProcessingService.copySimulation(e,t,i)])}async getSimulationId(e,t){const i=await this.findSimulationListItem(e,t);if(i)return i.id}async renameSimulation(e,t,i){const o=await this.getSimulationId(e,t);if(!o)throw new Error(`Unable to get simulation id for simulation: ${t}`);await Promise.all([this.waitForSimulationListUpdate(o.componentTypeRef),this.simulationProcessingService.renameDemo(o,i)])}async getNextSimulationFilePath(e,t){const i=await this.getSimulationList(e);for(const e of i)if(e.name!==t)return e.id.filePath}getSimulationListManager(){return this.simulationListManager}async findSimulationListItem(e,t){const i=await this.simulationListManager.getReady((0,n.getComponentRefObject)(e));return i.isValid()?i.getLatest().find((e=>e.name===t)):void 0}waitForSimulationListUpdate(e){return new Promise((t=>{const i=this.simulationListManager.get((0,n.getComponentRefObject)(e));i.isValid()&&i.subscribeOnce(t)}))}}}}]);