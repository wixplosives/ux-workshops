(self.webpackChunk_wixc3_component_playground=self.webpackChunk_wixc3_component_playground||[]).push([[5770],{24363:(e,t,s)=>{"use strict";s.r(t),s.d(t,{classes:()=>r,cssStates:()=>c,keyframes:()=>n,namespace:()=>i,st:()=>d,stVars:()=>o,style:()=>u,vars:()=>a});const i="o86",r={root:"s673",permissionModal:"s674"},n={},o={},a={},c=s.stc.bind(null,i),u=s.sts.bind(null,i),d=u},20329:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.universalCtrl=t.MOUSE=t.KEYBOARD=void 0;const i=s(91570);t.KEYBOARD={UNIDENTIFIED:"Unidentified",ESCAPE:"Escape",MINUS:"Minus",DASH:"Minus",EQUALS:"Equal",BACK_SPACE:"Backspace",TAB:"Tab",ENTER:"Enter",RETURN:"Enter",SHIFT:"Shift",CONTROL:"Control",ALT:"Alt",PAUSE:"Pause",CAPS_LOCK:"CapsLock",SPACE:"Space",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",PRINTSCREEN:"PrintScreen",INSERT:"Insert",DELETE:"Delete",0:"Digit0",1:"Digit1",2:"Digit2",3:"Digit3",4:"Digit4",5:"Digit5",6:"Digit6",7:"Digit7",8:"Digit8",9:"Digit9",A:"KeyA",B:"KeyB",C:"KeyC",D:"KeyD",E:"KeyE",F:"KeyF",G:"KeyG",H:"KeyH",I:"KeyI",J:"KeyJ",K:"KeyK",L:"KeyL",M:"KeyM",N:"KeyN",O:"KeyO",P:"KeyP",Q:"KeyQ",R:"KeyR",S:"KeyS",T:"KeyT",U:"KeyU",V:"KeyV",W:"KeyW",X:"KeyX",Y:"KeyY",Z:"KeyZ",META:"Meta",OS_LEFT:"OSLeft",CONTEXT_MENU:"ContextMenu",NUMPAD0:"Numpad0",NUMPAD1:"Numpad1",NUMPAD2:"Numpad2",NUMPAD3:"Numpad3",NUMPAD4:"Numpad4",NUMPAD5:"Numpad5",NUMPAD6:"Numpad6",NUMPAD7:"Numpad7",NUMPAD8:"Numpad8",NUMPAD9:"Numpad9",NUMPAD_MULTIPLY:"NumpadMultiply",NUMPAD_ADD:"NumpadAdd",NUMPAD_SUBTRACT:"NumpadSubtract",NUMPAD_DECIMAL:"NumpadDecimal",NUMPAD_DIVIDE:"NumpadDivide",NUMPAD_ENTER:"NumpadEnter",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",F13:"F13",F14:"F14",F15:"F15",F16:"F16",F17:"F17",F18:"F18",F19:"F19",F20:"F20",F21:"F21",F22:"F22",F23:"F23",F24:"F24",NUM_LOCK:"NumLock",SCROLL_LOCK:"ScrollLock",SEMICOLON:"Semicolon",COMMA:"Comma",PERIOD:"Period",SLASH:"Slash",BACK_QUOTE:"Backquote",OPEN_BRACKET:"BracketLeft",BACK_SLASH:"Backslash",CLOSE_BRACKET:"BracketRight",QUOTE:"Quote",UNIVERSAL_CONTROL:i.isMac?"Meta":"Control"},t.MOUSE={WHEEL_VERTICAL:"wheelVertical",WHEEL_HORIZONTAL:"wheelHorizontal"},t.universalCtrl=i.isMac?t.KEYBOARD.META:t.KEYBOARD.CONTROL},90925:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(5163);i.__exportStar(s(20329),t),i.__exportStar(s(31287),t)},31287:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},62202:(e,t,s)=>{e.exports=s(90925)},74853:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(5163),r=s(93849),n=i.__importStar(s(2206)),o=i.__importDefault(s(20471)),a=i.__importDefault(s(93208));t.default=new r.Feature({id:"firebaseFsPersistency",dependencies:[n.default.asEntity,o.default.asEntity,a.default.asEntity],api:{firebaseFsServiceProcessing:r.Service.withType().defineEntity(n.processingEnv).allowRemoteAccess((0,r.declareComEmitter)("onFileSystemChange","removeFileSystemChangeHandler"))}})},64281:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(5163),r=s(5689),n=i.__importDefault(s(74853)),o=s(30721);n.default.setup(r.mainEnv,(({run:e,onDispose:t,firebaseFsServiceProcessing:s},{firebasePersistency:{firebasePersistencyService:i,firebaseCloneHandlers:r},project:{},gui:{panelStore:n}})=>{const a=new o.FirebaseFsServiceMain(i,s,n);r.register(a.cloneHandler.bind(a)),t(a.onDispose),e((()=>{}))}))},66526:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseFsServiceMain=void 0;const i=s(39448),r=s(83135),n=s(26249),o=s(63372),a=s(24363),c="fsPersistency",u="filesystem",d="files";function l(e){return encodeURIComponent(e).replaceAll(".","%2E")}t.FirebaseFsServiceMain=class{constructor(e,t,s){this.firebasePersistencyService=e,this.firebaseFsProcessingService=t,this.panelStore=s,this.isLoading=!0,t.onFileSystemChange(this.handleFileSystemChange.bind(this)),e.firebasePersistencyEvents.on("readiness",this.isReadyHandler.bind(this)),e.firebasePersistencyEvents.on("permissionMismatch",this.openModal.bind(this))}onDispose(){this.firebasePersistencyService.firebasePersistencyEvents.off("readiness",this.isReadyHandler.bind(this)),this.firebasePersistencyService.firebasePersistencyEvents.off("permissionMismatch",this.openModal.bind(this))}async isReadyHandler(e){if(e===i.ReadinessEvent.INVALID_ID_EVENT)(0,r.openToastNotification)({panelStore:this.panelStore,props:{title:"Project not found",text:"initializing default project",type:"error",dismissButton:!0}});else if(e===i.ReadinessEvent.READY_EVENT){const e=this.firebasePersistencyService.getRootDocumentId();if(e){const t=await this.firebasePersistencyService.read(`${e}/fsPersistency/filesystem`);if(t){const e=await t.getValue(d).getLatest();e&&await this.firebaseFsProcessingService.populateFs(e)}}}this.isLoading=!1}async handleFileSystemChange(e,t){if(!this.isLoading){const s=await this.firebasePersistencyService.assureRootDocumentExists(),i=this.firebasePersistencyService.getRootDocumentId(),r=await this.firebaseFsProcessingService.getCurrentFsContents();if(i){let n=await this.firebasePersistencyService.read(`${i}/fsPersistency/filesystem`);const o={},a=l(e);if(!n&&s){for(const[e,t]of Object.entries(r))o[l(e)]=t;this.firebasePersistencyService.createCollection(c,i),n=await this.firebasePersistencyService.create(`${i}/fsPersistency`,{[d]:o},u)}else if(n&&Object.keys(r).length){const s=n.getValue(d);void 0!==t?(r[e]=t,await s.persistField(t,a)):void 0!==(await s.getLatest())[a]&&await this.firebasePersistencyService.deleteField(n.getId(),`files.${a}`)}}}}async cloneHandler(e,t){const s=await this.firebaseFsProcessingService.getCurrentFsContents(),i={};for(const[e,t]of Object.entries(s))i[l(e)]=t;this.firebasePersistencyService.createCollection(c,t.getId()),Object.keys(i).length&&await this.firebasePersistencyService.create(`${t.getId()}/fsPersistency`,{[d]:i},u)}openModal(){this.panelStore.openOverlay({id:"permissionMismatch",panelType:n.ASYNC_CONFIRMATION_MODAL_ID,panelProps:{title:"Permission denied",className:a.classes.permissionModal,content:"You are not the owner of this project. Would you like to clone a new version of it?",onClose:()=>this.panelStore.closePanel("permissionMismatch"),actionButtonText:"Clone",dismissButton:!0,onAction:this.permissionModalHandler.bind(this),actionButtonProps:{className:o.classes.primaryButton}}})}async permissionModalHandler(){const e=this.firebasePersistencyService.getRootDocumentId(),t=e&&await this.firebasePersistencyService.read(e);t&&(await this.firebasePersistencyService.clone(t),this.panelStore.closePanel("permissionMismatch"))}}},30721:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseFsServiceMain=void 0;var i=s(66526);Object.defineProperty(t,"FirebaseFsServiceMain",{enumerable:!0,get:function(){return i.FirebaseFsServiceMain}})},94703:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(5163),r=s(93849),n=s(5689),o=i.__importDefault(s(93208)),a=s(9011);t.default=new r.Feature({id:"firebasePersistency",dependencies:[o.default.asEntity],api:{firebasePersistencyServiceOptions:new r.Config({rootCollectionId:"projects",testingMode:!1}),firebaseConfig:new r.Config(a.firebaseConfig),firebasePersistencyService:r.Service.withType().defineEntity(n.mainEnv),firebaseAuthService:r.Service.withType().defineEntity(n.mainEnv),firebaseCloneHandlers:r.Slot.withType().defineEntity(n.mainEnv)}})},70537:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(94703);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(r).default}})},85470:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseAuthService=void 0;const i=s(93849),r=s(75102);t.FirebaseAuthService=class{constructor(e){this.firebaseAuth=e,this.currentUser=null,this.firebaseAuthEvents=new i.EventEmitter,this.unsubscribeFromFirebaseAuth=(0,r.onAuthStateChanged)(this.firebaseAuth,(e=>{this.currentUser=e,this.firebaseAuthEvents.emit("change",this.currentUser),e||this.signInAnonymously().catch(i.reportError)}))}onDispose(){this.unsubscribeFromFirebaseAuth()}subscribeToAuthChange(e){this.firebaseAuthEvents.subscribe("change",e)}unsubscribeToAuthChange(e){this.firebaseAuthEvents.subscribe("change",e)}getAuth(){return this.firebaseAuth}getCurrentUser(){return this.currentUser}async signInAnonymously(){await(0,r.signInAnonymously)(this.firebaseAuth)}async signOut(){return this.firebaseAuth.signOut()}async deleteUser(e){await e.delete()}}},88967:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirebasePersistencyService=t.ReadinessEvent=t.URL_PROJECT_ID_KEY=t.UPGRADE_PENDING_FIELD=t.OWNER_ID_FIELD=void 0;const i=s(93849),r=s(83135),n=s(61008);var o;t.OWNER_ID_FIELD="ownerId",t.UPGRADE_PENDING_FIELD="upgradePending",t.URL_PROJECT_ID_KEY="projectId",function(e){e[e.INVALID_ID_EVENT=0]="INVALID_ID_EVENT",e[e.READY_EVENT=1]="READY_EVENT",e[e.NEW_PROJECT_EVENT=2]="NEW_PROJECT_EVENT"}(o=t.ReadinessEvent||(t.ReadinessEvent={})),t.FirebasePersistencyService=class{constructor(e,t,s,r){this.firebaseAuth=e,this.firestore=t,this.cloneHandlers=s,this.rootCollectionId="projects",this.upgradePending=!1,this.firebasePersistencyEvents=new i.EventEmitter,this.rootCollectionId=(null==r?void 0:r.rootCollectionId)||this.rootCollectionId,this.firebaseAuth.subscribeToAuthChange(this.onAuthChange.bind(this))}async onAuthChange(){const e=new URL(document.location.toString()).searchParams.get(t.URL_PROJECT_ID_KEY);if(e&&!this.rootDocumentId){const s=`${this.rootCollectionId}/${e}`;if(await this.read(s))this.setRootDocumentId(s),this.firebasePersistencyEvents.emit("readiness",o.READY_EVENT);else{this.firebasePersistencyEvents.emit("readiness",o.INVALID_ID_EVENT);const e=new URL(document.location.toString());e.searchParams.delete(t.URL_PROJECT_ID_KEY),r.historyController.push(e.toString()),this.firebasePersistencyEvents.emit("readiness",o.READY_EVENT)}}else e||this.firebasePersistencyEvents.emit("readiness",o.NEW_PROJECT_EVENT)}getRootCollectionId(){return this.rootCollectionId}getRootDocumentId(){return this.rootDocumentId}setRootDocumentId(e){const s=new URL(document.location.toString()),i=s.searchParams.get(t.URL_PROJECT_ID_KEY);if(e)this.rootDocumentId!==e&&(this.rootDocumentId=e,i!==e&&(s.searchParams.set(t.URL_PROJECT_ID_KEY,e.slice(this.rootCollectionId.length+1)),r.historyController.push(s.toString())));else if(this.rootDocumentId=void 0,i){const e=new URL(document.location.toString());e.searchParams.delete(t.URL_PROJECT_ID_KEY),r.historyController.push(e.toString()),document.location.reload()}}async assureRootDocumentExists(){const e=this.rootDocumentId?await this.read(this.rootDocumentId):await this.create(this.rootCollectionId,{});return e&&this.setRootDocumentId(e.getId()),e}async getDocumentOwnerId(e){var s;const i=await this.read(e);return null===(s=null==i?void 0:i.getValue(t.OWNER_ID_FIELD))||void 0===s?void 0:s.getLatest()}setDocumentOwnerId(e,s){return this.update(e,t.OWNER_ID_FIELD,s)}createCollection(e,t){if(t){const s=(0,n.doc)(this.firestore,t);(0,n.collection)(s,e)}else(0,n.collection)(this.firestore,e)}async create(e,t,s){const i=(0,n.collection)(this.firestore,e),r=this.firebaseAuth.getCurrentUser();if(e===this.rootCollectionId&&r&&(t.ownerId=r.uid),s){const e=(0,n.doc)(this.firestore,i.path,s);return await(0,n.setDoc)(e,t),this.read(e.path)}{const e=await(0,n.addDoc)(i,t);return this.read(e.path)}}async read(e){const t=(0,n.doc)(this.firestore,e),s=await(0,n.getDoc)(t);return s.exists()?this.getActiveDocument(e,s):void 0}async update(e,t,s){const i=(0,n.doc)(this.firestore,e);await(0,n.updateDoc)(i,t,s).catch((e=>{this.firebasePersistencyEvents.emit("permissionMismatch",void 0)}))}async prepareUserOwnershipChange(){var e,s;const i=this.getRootDocumentId();if(i&&(null===(e=this.firebaseAuth.getCurrentUser())||void 0===e?void 0:e.isAnonymous)){const e=await this.getDocumentOwnerId(i);(null===(s=this.firebaseAuth.getCurrentUser())||void 0===s?void 0:s.uid)===e&&(this.upgradePending=!0,await this.update(i,t.UPGRADE_PENDING_FIELD,!0))}}async cancelUserOwnershipChange(){var e;const s=this.getRootDocumentId();if(s&&this.upgradePending){const i=await this.getDocumentOwnerId(s);(null===(e=this.firebaseAuth.getCurrentUser())||void 0===e?void 0:e.uid)===i&&(await this.deleteField(s,t.UPGRADE_PENDING_FIELD),this.upgradePending=!1)}}isUserOwnershipChangePending(){return this.upgradePending}deleteDoc(e){const t=(0,n.doc)(this.firestore,e);return(0,n.deleteDoc)(t)}async deleteField(e,t){const s=(0,n.doc)(this.firestore,e);return(0,n.updateDoc)(s,t,(0,n.deleteField)())}async clone(e){const t=(0,n.doc)(this.firestore,e.getId()),s=await(0,n.getDoc)(t),i=await this.create(this.getDocCollectionId(e),s.data());if(i){const t=i.getId(),s=this.firebaseAuth.getCurrentUser();s&&(this.setRootDocumentId(t),await this.setDocumentOwnerId(t,s.uid));for(const t of this.cloneHandlers)await t(e,i)}return i}getDocCollectionId(e){return(0,n.doc)(this.firestore,e.getId()).parent.path}getActiveDocument(e,t){return{getValue:s=>({persist:t=>this.update(e,s,t),persistField:(t,i)=>this.update(e,`${s}.${i}`,t),async getLatest(){const e=await(0,n.getDoc)(t.ref);if(e.exists())return e.get(s)}}),getId:()=>t.ref.path,dispose:()=>{}}}}},50041:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPGRADE_PENDING_FIELD=t.ReadinessEvent=t.OWNER_ID_FIELD=t.FirebasePersistencyService=t.FirebaseAuthService=void 0;var i=s(85470);Object.defineProperty(t,"FirebaseAuthService",{enumerable:!0,get:function(){return i.FirebaseAuthService}});var r=s(88967);Object.defineProperty(t,"FirebasePersistencyService",{enumerable:!0,get:function(){return r.FirebasePersistencyService}}),Object.defineProperty(t,"OWNER_ID_FIELD",{enumerable:!0,get:function(){return r.OWNER_ID_FIELD}}),Object.defineProperty(t,"ReadinessEvent",{enumerable:!0,get:function(){return r.ReadinessEvent}}),Object.defineProperty(t,"UPGRADE_PENDING_FIELD",{enumerable:!0,get:function(){return r.UPGRADE_PENDING_FIELD}})},9011:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firebaseConfig=void 0,t.firebaseConfig={apiKey:"AIzaSyD-IS7lkB3o9GioLGayvTlOAgl2EFQnKrY",authDomain:"localhost",projectId:"demo-project",storageBucket:"core3-firebase-9b327.appspot.com",messagingSenderId:"491604166384",appId:"1:491604166384:web:fb676c56b4fdb306bd6435"}},20471:(e,t,s)=>{e.exports=s(70537)},39448:(e,t,s)=>{e.exports=s(50041)},77419:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(5163);i.__exportStar(s(41583),t),i.__exportStar(s(49249),t),i.__exportStar(s(42068),t)},42068:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shortcuts=void 0;const i=s(62202);t.shortcuts={toggleSideMenu:[i.KEYBOARD.UNIVERSAL_CONTROL,i.KEYBOARD.SHIFT,i.KEYBOARD.M],save:[i.KEYBOARD.UNIVERSAL_CONTROL,i.KEYBOARD.S],toggleNextTab:[i.KEYBOARD.CONTROL,i.KEYBOARD.BACK_QUOTE],togglePreviousTab:[i.KEYBOARD.CONTROL,i.KEYBOARD.SHIFT,i.KEYBOARD.BACK_QUOTE],toggleLastTab:[i.KEYBOARD.CONTROL,i.KEYBOARD.SHIFT,i.KEYBOARD.L],toggleAllMenus:[i.KEYBOARD.UNIVERSAL_CONTROL,i.KEYBOARD.SHIFT,i.KEYBOARD.A],closeTab:[i.KEYBOARD.UNIVERSAL_CONTROL,i.KEYBOARD.W]}},83135:(e,t,s)=>{e.exports=s(77467)},26249:(e,t,s)=>{e.exports=s(77419)},43934:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const i=s(5163);i.__exportStar(s(31434),t);var r=s(31434);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.__importDefault(r).default}})},2206:(e,t,s)=>{e.exports=s(43934)}}]);