(self.webpackChunk_wixc3_component_playground=self.webpackChunk_wixc3_component_playground||[]).push([[3868],{98180:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.directoryManipulator=t.directoryReducer=t.DirectoryChangeKind=void 0,function(e){e.FULL="full",e.ADD="add",e.REMOVE="remove"}(n=t.DirectoryChangeKind||(t.DirectoryChangeKind={})),t.directoryReducer=(e,t)=>{switch(t.kind){case n.FULL:return{value:t.value,invertingChanges:[{kind:n.FULL,value:e}]};case n.ADD:return{value:[...e,t.node],invertingChanges:[{kind:n.FULL,value:e}]};case n.REMOVE:return{value:e.filter((e=>e.name!==t.name)),invertingChanges:[{kind:n.FULL,value:e}]};default:return{value:e,invertingChanges:[{kind:n.FULL,value:e}]}}},t.directoryManipulator={reducer:t.directoryReducer}},61276:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileScannerComputeHandler=t.getDirectoryEntities=t.traverseFs=void 0;const s=n(93849),r=n(98180);t.traverseFs=function e({directoryPath:t,fs:n,filterFile:r=s.returnsTrue,filterDirectory:i=s.returnsTrue,directories:a=[],files:o=[]}){const{readdirSync:c}=n;a.push({path:t,name:n.basename(t)});for(const s of c(t,{withFileTypes:!0})){const c=s.name,l=n.join(t,c);s.isDirectory()&&i(l,c)?e({directoryPath:l,fs:n,filterFile:r,filterDirectory:i,directories:a,files:o}):s.isFile()&&r(l,c)&&o.push({path:l,name:c})}return{directories:a,files:o}},t.getDirectoryEntities=function({directoryPath:e,fs:t}){const{readdirSync:n}=t,s={directories:[],files:[]};for(const r of n(e,{withFileTypes:!0})){const n=r.name,i=t.join(e,n);r.isDirectory()?s.directories.push({path:i,name:n}):r.isFile()&&s.files.push({path:i,name:n})}return s},t.FileScannerComputeHandler=class{constructor(e,t,n,s,r){this.controller=e,this.manipulator=t,this.fs=n,this.pathPredicate=s,this.directoryManager=r}compute(e){let t=this.controller.getEmptyValue();const{changes:n,dependencies:s}=this.addDirectory(e,t);for(const e of n)t=this.manipulator.reducer(t,e).value;return{value:t,dependencies:s,status:{valid:!0}}}recompute(e,t,n,s){const r=e.getLatest(),i=[];let a=new Set(s);for(const e of n){if(!e.isValid())continue;const n=e.getType(),{changes:s,dependencies:o}=this.getDirectoryRelatedUpdates(e,t[n][e.getSerializedId()],r,a);i.push(...s),a=o}const o=Array.from(s).filter((e=>!e.isValid()));return{dependencies:new Set([...a].filter((e=>!o.includes(e)))),changes:i,status:{valid:!0}}}addDirectory(e,t){const n=new Set,{files:s,directoryResources:r}=this.addDirRecurse(e),i=[],a=this.controller.onFilesAdded(t,s.map((({path:e})=>e)));return r.forEach((e=>n.add(e))),i.push(...a.changes),{changes:i,dependencies:n}}addDirRecurse(e,t=[],n=[],s=[]){const r=this.directoryManager.get(e);s.push(r);const i=r.getLatest();for(const r of i){const i={name:r.name,path:this.fs.join(e,r.name)};this.pathPredicate(i.path)&&(r.stats.isDirectory?(t.push(i),this.addDirRecurse(i.path,t,n,s)):r.stats.isFile&&this.controller.predicate(i.path)&&n.push(i))}return{files:n,directories:t,directoryResources:s}}getDirectoryRelatedUpdates(e,t,n,s){if(t.isDisposed())return{changes:[],dependencies:s};const i=[],a=new Set(s),o=e.getChangesFromVersion(t),c=e.getId();return o.forEach((e=>{if(e.kind===r.DirectoryChangeKind.ADD){const t=this.fs.join(c,e.node.name);if(e.node.stats.isDirectory){if(this.pathPredicate(t)){const{changes:e,dependencies:s}=this.addDirectory(t,n);for(const e of s)a.add(e);i.push(...e)}}else if(this.pathPredicate(t)&&this.controller.predicate(t)){const{changes:e}=this.controller.onFilesAdded(n,[t]);i.push(...e)}}else if(e.kind===r.DirectoryChangeKind.REMOVE){const t=this.fs.join(c,e.name);i.push(...this.controller.onRemoved(n,t))}})),{changes:i,dependencies:a}}}},33506:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removePrefixPath=t.createPathPredicate=t.directoryDeepChildren=t.getPathsOfFilePath=t.getTreeNodePath=void 0;const s=n(71876),r=n(73654),i=n(91570);function a(e,t){return e.split(t).filter((e=>!!e))}function o(){return!0}t.getTreeNodePath=a,t.getPathsOfFilePath=function(e,t){var n;const s=e?a(e,t):[],r=[];for(let e=0;e<s.length;e++)r.push((null!==(n=r[e-1])&&void 0!==n?n:"")+t+s[e]);return r},t.directoryDeepChildren=async function*e(t,n,s=o,r=n){for(const i of await t.promises.readdir(n,{withFileTypes:!0})){const a=i.name,o=t.join(n,a),c=t.relative(r,o);if(i.isFile()){const e={type:"file",path:o,name:a,relativePath:c};s(e)&&(yield e)}else if(i.isDirectory()){const n={type:"directory",path:o,name:a,relativePath:c};s(n)&&(yield n,yield*e(t,o,s,r))}}},t.createPathPredicate=function(e,t,n){const r=n.map((e=>(0,s.makeRe)(e)));return n=>{const s=e.relative(t,n);return!r.some((e=>e.test(s)))}},t.removePrefixPath=(e,t)=>e?(0,i.replaceWinSlashes)(r.win32.relative(e,t)):(0,i.replaceWinSlashes)(t)},18012:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5163);s.__exportStar(n(78204),t),s.__exportStar(n(98180),t),s.__exportStar(n(33506),t),s.__exportStar(n(98073),t),s.__exportStar(n(61276),t)},98073:(e,t)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.NodeType=t.FsEventType=void 0,(s=t.FsEventType||(t.FsEventType={}))[s.CREATE=0]="CREATE",s[s.LOAD=1]="LOAD",s[s.UPDATE=2]="UPDATE",s[s.DELETE=3]="DELETE",(n=t.NodeType||(t.NodeType={}))[n.directory=0]="directory",n[n.file=1]="file",n[n.virtual=2]="virtual",n[n.none=3]="none"},69144:(e,t,n)=>{e.exports=n(18012)},48541:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const s=n(5163);s.__exportStar(n(17831),t);var r=n(17831);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.__importDefault(r).default}})},17831:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5163),r=n(93849),i=n(32510),a=s.__importStar(n(2206)),o=s.__importDefault(n(89111)),c=n(5689),l=n(46726),d=(0,i.defineTwoWayComputedResource)().defineEntity(a.processingEnv),p=(0,i.defineOneWayResource)().defineEntity(a.processingEnv),u=(0,i.defineComputedResource)().defineEntity(a.processingEnv);t.default=new r.Feature({id:"simpleAST",dependencies:[a.default.asEntity,o.default.asEntity,r.COM.asEntity],api:{idService:r.Service.withType().defineEntity(a.processingEnv),remoteIdService:r.Service.withType().defineEntity(a.processingEnv).allowRemoteAccess(),codeService:r.Service.withType().defineEntity(a.processingEnv).allowRemoteAccess(),sourceIdResource:u,sourceIdResourceMain:u.defineConsumer(c.mainEnv),idGenerator:r.Service.withType().defineEntity(r.Universal),simpleASTPlugin:r.Slot.withType().defineEntity(r.Universal),languagePlugin:r.Slot.withType().defineEntity(a.processingEnv),languageASTPlugin:r.Slot.withType().defineEntity(a.processingEnv),languageASTFallbackPlugin:r.Slot.withType().defineEntity(a.processingEnv),languageASTPassthroughPlugin:r.Slot.withType().defineEntity(a.processingEnv),simpleAST:d,simpleASTMain:d.defineConsumer(c.mainEnv),simpleASTPluginRepo:r.Service.withType().defineEntity(r.Universal),astVisualizer:r.Slot.withType().defineEntity(c.mainEnv),simpleASTDiagnostics:p,simpleASTDiagnosticsMain:p.defineConsumer(c.mainEnv)}}).setup(r.Universal,(({simpleASTPlugin:e,simpleAST:t},{COM:n})=>{const s=new l.NodePluginRepo;e.stream((e=>{s.registerPlugin(e)})),l.commonSimpleAstParsers.forEach((t=>e.register(t)));const r=n.communication.getEnvironmentId(),i={};return{simpleASTPluginRepo:s,simpleAST:t,idGenerator:{generateId:e=>(i[e]||(i[e]=(0,l.createPrefixCounter)(r).nextId),i[e]())}}}))},94400:(e,t,n)=>{e.exports=n(48541)},9240:(e,t,n)=>{e.exports=n(46726)},98582:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAstNodeSchemaManager=t.refSchemaManager=t.moduleSymbolsSchemaManager=t.componentSchemaManager=void 0;const s=n(5163),r=n(93849),i=n(32510),a=n(5689),o=s.__importStar(n(2206)),c=s.__importDefault(n(89111)),l=s.__importDefault(n(94400));t.componentSchemaManager=(0,i.defineComputedResource)().defineEntity(o.processingEnv),t.moduleSymbolsSchemaManager=(0,i.defineComputedResource)().defineEntity(o.processingEnv),t.refSchemaManager=(0,i.defineComputedResource)().defineEntity(o.processingEnv),t.simpleAstNodeSchemaManager=(0,i.defineComputedResource)().defineEntity(o.processingEnv),t.default=new r.Feature({id:"symbolSchemaExtract",dependencies:[o.default.asEntity,c.default.asEntity,l.default.asEntity],api:{schemaService:r.Service.withType().defineEntity(o.processingEnv).allowRemoteAccess(),componentSchemaManager:t.componentSchemaManager,componentSchemaManagerMain:t.componentSchemaManager.defineConsumer(a.mainEnv),moduleSymbolsSchemaManager:t.moduleSymbolsSchemaManager,moduleSymbolsSchemaManagerMain:t.moduleSymbolsSchemaManager.defineConsumer(a.mainEnv),refSchemaManager:t.refSchemaManager,refSchemaManagerMain:t.refSchemaManager.defineConsumer(a.mainEnv),simpleAstNodeSchemaManager:t.simpleAstNodeSchemaManager,simpleAstNodeSchemaManagerMain:t.simpleAstNodeSchemaManager.defineConsumer(a.mainEnv),schemaConfig:new r.Config({getSchemasDebounceTime:500,getSchemasMaxDebounceTime:2e3}),computeSchemaCacheEnvs:r.Service.withType().defineEntity(o.processingEnv)},context:{schemaExtractContext:o.processingEnv.withContext()}})},9466:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5163).__importDefault(n(98582)),r=n(22988),i=n(13486),a=n(91834),o=n(98838),c=n(2206),l=n(69144),d=n(24027);s.default.setup(c.processingEnv,(({componentSchemaManager:e,moduleSymbolsSchemaManager:t,refSchemaManager:n,schemaConfig:s,simpleAstNodeSchemaManager:p},{typescript:{languageIntellisense:u},project:{projectService:h,fileManager:m,virtualFs:g,fsResourcesSyncer:f,pluggableProjectConfig:S,ignoredSubPathsConfig:y},simpleAST:{simpleAST:v,idService:P}},{schemaExtractContext:T})=>{const E=S.get(c.PROJECT_CONFIG_NAME),_=E.isValid()?E.get(y):c.DEFAULT_IGNORED_SUBPATHS,C=(0,l.createPathPredicate)(h.fs,h.getProjectPath(),_),b=new i.SchemaService(u,f,T),M=e.provide({dependencies:[m],handler:new r.ComponentSchemaComputeHandler(m,g,u,b,C,(()=>h.getProjectPath()),s.getSchemasDebounceTime,s.getSchemasMaxDebounceTime)}),A=t.provide({dependencies:[m],handler:new a.ModuleSymbolsSchemaComputeHandler(m,u,b)}),w=n.provide({dependencies:[m],handler:new o.RefSchemaComputeHandler(m,b)}),R=p.provide({dependencies:[v],handler:new d.SimpleAstNodeSchemaComputeHandler(b,v,P,u)});return{schemaService:b,componentSchemaManager:M,moduleSymbolsSchemaManager:A,refSchemaManager:w,simpleAstNodeSchemaManager:R,computeSchemaCacheEnvs:function(e,t){const n=new Set;t.length&&"/"===t.charAt(t.length-1)&&(t=t.slice(0,-1)),b.changeSettings({adjustFilePath:e=>e.replace(t,"")});for(const t of e){try{b.getModuleSchema(t)}catch{}n.add(b.getSchemaBuilder(t))}const s=[];for(const e of n){const t=e.exportSchemaCache();s.push(t)}return s}}}))},22988:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentSchemaComputeHandler=t.getRefFileName=t.WCS_PROPS_ANALYZER_TYPE_NAME=t.WCS_PROPS_ANALYZER_PREFIX=void 0;const s=n(5163),r=n(73654),i=n(37894),a=n(60814),o=n(91570),c=s.__importDefault(n(72321)),l=n(93849);t.WCS_PROPS_ANALYZER_PREFIX="/tmp_wcs_props_analyzer_",t.WCS_PROPS_ANALYZER_TYPE_NAME="ResolvedProps",t.getRefFileName=e=>e.includes("#")?e.split("#")[0]:null,t.ComponentSchemaComputeHandler=class{constructor(e,t,n,s,r,i,a,l){this.fileManager=e,this.virtualFs=t,this.languageIntellisense=n,this.schemaService=s,this.pathPredicate=r,this.getProjectPath=i,this.getSymbolSchemas=(e,t)=>(c.default.mark("get-symbol-schemas"),this.schemaService.getSymbolSchemas(e,t)),this.debounceGetSymbolSchemas=new o.Debouncer(this.getSymbolSchemas,a,l)}async compute(e){const{filePath:t,componentSymbolName:n}=e;c.default.mark("schema-extract-compute");const s=this.languageIntellisense.getLanguageController(t,this);let r=new Set([t]);const i=await this.getPropsSchema(t,n,s,r),a=this.getSymbol(t,s,n),o=await this.schemaService.getSymbolSchemas(t,a),l=await this.getDtsDependenciesPaths(t,n);r=new Set([...r,...o.dependencies,...l]);const d=new Set;return r.forEach((e=>{this.pathPredicate(e)&&d.add(this.fileManager.get(e))})),{value:{componentSchema:o,propsSchema:i},dependencies:d,status:{valid:!0}}}recompute(e,t,n,s){c.default.mark("schema-extract-recompute");const{filePath:r,componentSymbolName:i}=e.getId(),o=this.languageIntellisense.getLanguageController(r,this),d=this.getSymbol(r,o,i);return this.debounceGetSymbolSchemas.trigger(r,d).then((async t=>{const n=new Set([r,...t.dependencies]),s={componentSchema:t,propsSchema:await this.getPropsSchema(r,i,o,n)};e.isValid()&&e.applyChange((0,a.fullChange)(s))})).catch(l.reportError),{changes:[],dependencies:s,status:(0,a.getDefaultStatusHandling)(e.getSerializedId(),s)}}async getDtsDependenciesPaths(e,t){const n=[],s=this.languageIntellisense.getLanguageController(e,this),r=(0,o.getDTSPath)(e);if(s.filePaths.has(r)){const e=this.getSymbol(r,s,t),i=await this.schemaService.getSymbolSchemas(r,e);n.push(r),i.dependencies.forEach((e=>{this.pathPredicate(e)&&n.push(e)}))}return n}async getPropsSchema(e,n,s,i){var a,o,c;const l=`${t.WCS_PROPS_ANALYZER_PREFIX}${Math.random().toString()}.ts`,d=(0,r.join)(this.getProjectPath(),l),p=this.generateTempFileContent(d,e,n);this.virtualFs.writeFileSync(l,p),s.filePaths.add(d),"flushVersion"in s.serviceHost&&s.serviceHost.flushVersion();const u=this.getSymbol(d,s,t.WCS_PROPS_ANALYZER_TYPE_NAME);let h=null!==(a=this.schemaService.getTypeSchema(d,u,!0))&&void 0!==a?a:{};const m=new Map;if(h.$ref){const e=h.$ref,n=(0,t.getRefFileName)(e);n&&(i.add(n),h=null!==(c=null===(o=await this.schemaService.getSchemaByReference(e,!0))||void 0===o?void 0:o.schema)&&void 0!==c?c:{},m.set(e,h))}return s.filePaths.delete(d),this.virtualFs.removeSync(l),h}generateTempFileContent(e,n,s){const r=(0,o.rebaseRelativeModulePath)(e,n),i=(0,o.replaceWinSlashes)((0,o.getImportPath)(r)),a="default"===s?"TargetComponent":s;return`\n        ${"default"===s?`import ${a} from '${i}';`:`import { ${a} } from '${i}';`}\n\n        import type { ComponentType } from "react";\n        import type PropTypes from "prop-types";\n\n     \n        type ComponentProps<\n            T extends keyof JSX.IntrinsicElements | ComponentType<any>\n        > = T extends ComponentType<infer P>\n            ? P\n            : T extends keyof JSX.IntrinsicElements\n            ? JSX.IntrinsicElements[T]\n            : {};\n      \n        type GetPropsFromPropTypes<\n            T extends keyof JSX.IntrinsicElements | ComponentType<any>\n        > = T extends ComponentType<any>\n            ? T["propTypes"] extends undefined\n            ? {}\n            : PropTypes.InferProps<T["propTypes"]>\n            : never;\n      \n        type IfAny<T, WhenTIsAny, WhenTIsNotAny> = 0 extends 1 & T ? WhenTIsAny : WhenTIsNotAny;\n\n        type TakeFirstLikeProps<T1, T2> = IfAny<T1, T2, T1>;\n        \n        /** \n         * There are two places we scan for props: \n         *  - types that are specified in ts and can be get with ComponentProps (ComponentType<infer P>)\n         *  - user defined propTypes from "prop-types" package inferred with GetPropsFromPropTypes (PropTypes.InferProps<T["propTypes"]>)\n         *    e.g. \n         *    MyComponent.propTypes = {\n         *         children: PropTypes.node.isRequired,\n         *         className: PropTypes.string,\n         *    }\n         * \n         *    Typescript types takes precedence over prop-types inferred types,\n         *    thus we take prop-types types only if typescript types props are resolved to any.\n         *    Type util TakeFirstLikeProps uses IfAny to test first generic type parameter for any and uses respective type as a result.\n         */\n\n        export type DetectedProps = TakeFirstLikeProps<\n            ComponentProps<typeof ${a}>,\n            GetPropsFromPropTypes<typeof ${a}>\n        >;\n        \n        export type ${t.WCS_PROPS_ANALYZER_TYPE_NAME} = Pick<DetectedProps, keyof DetectedProps>;\n    `}getSymbol(e,t,n){const s=t.languageService.getProgram();if(!s)throw new Error(`Can't get program for file ${e}`);const r=s.getSourceFile(e),i=s.getTypeChecker();if(!r)throw new Error(`Can't get sourceFile for file ${e}`);const a=this.findSymbol(n,r,i);if(!a)throw new Error(`No symbol found with a name ${n} in file ${e}`);return a}findSymbol(e,t,n){return(0,i.getExportedSymbols)(t,n).find((t=>t.name===e))}}},91834:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleSymbolsSchemaComputeHandler=void 0;const s=n(60814),r=n(37894);t.ModuleSymbolsSchemaComputeHandler=class{constructor(e,t,n){this.fileManager=e,this.languageIntellisense=t,this.schemaService=n}async compute(e){const t=new Set,n=this.fileManager.get(e);if(t.add(n),!n.isValid())return{dependencies:t,value:{exportedSymbols:[],localSymbols:[]},status:{valid:!1,message:`'${e}' is deleted`}};const s=this.languageIntellisense.getLanguageController(e,this).languageService.getProgram(),i=null==s?void 0:s.getSourceFile(e),a=null==s?void 0:s.getTypeChecker(),o=i&&a?await this.getSymbolsSchema(e,(0,r.getExportedSymbols)(i,a)||[]):[],c=i?await this.getSymbolsSchema(e,(0,r.getLocalSymbols)(i)||[]):[];for(const e of[...o,...c])for(const n of e.dependencies)t.add(this.fileManager.get(n));return{dependencies:t,value:{exportedSymbols:o,localSymbols:c},status:{valid:!0}}}async recompute(e,t,n,r){const{value:i,status:a}=await this.compute(e.getId());return{changes:JSON.stringify(i)!==JSON.stringify(e.getLatest())?[(0,s.fullChange)(i)]:[],dependencies:r,status:a.valid?(0,s.getDefaultStatusHandling)(e.getSerializedId(),r):a}}async getSymbolsSchema(e,t){return Promise.all(t.map((t=>this.schemaService.getSymbolSchemas(e,t))))}}},98838:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RefSchemaComputeHandler=void 0;const s=n(60814);t.RefSchemaComputeHandler=class{constructor(e,t){this.fileManager=e,this.schemaService=t}compute(e){var t;const[n]=e.split("#"),r=null!==(t=this.schemaService.getSymbolSchemasByReference(e))&&void 0!==t?t:null,i=new Set;return i.add(this.fileManager.get(n)),null==r||r.dependencies.forEach((e=>{i.add(this.fileManager.get(e))})),{value:r,dependencies:i,status:(0,s.getDefaultStatusHandling)(e,i)}}recompute(e,t,n,r){const{value:i}=this.compute(e.getId());return{changes:[(0,s.fullChange)(i)],dependencies:r,status:(0,s.getDefaultStatusHandling)(e.getSerializedId(),r)}}}},24027:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleAstNodeSchemaComputeHandler=void 0;const s=n(5163).__importDefault(n(60270)),r=n(60814),i=n(9240),a=n(49262),o=(e,t)=>({status:{valid:!1,message:`Typescript symbol for node ${e} not found`},value:null,dependencies:t});t.SimpleAstNodeSchemaComputeHandler=class{constructor(e,t,n,s){this.schemaService=e,this.simpleAstResourceManager=t,this.idService=n,this.languageIntellisense=s}async compute(e){var t;const{filePath:n,simpleAstNodeId:a}=e,c=await this.simpleAstResourceManager.getReady({filePath:n,parsers:i.commonSimpleAstParsers.map((e=>e.nodeKind))}),l=new Set([c]),d=this.languageIntellisense.getLanguageController(n,this).languageService.getProgram(),p=null==d?void 0:d.getSourceFile(n);if(!p)return{status:{valid:!1,message:`Can't get sourceFile for file ${n}`},value:null,dependencies:l};const u=this.idService.getFileAPI(n).getNodeByID(a),h=s.default.getTokenAtPosition(p,u.pos);if(s.default.isArrayLiteralExpression(h.parent))return this.computeArrayItemSchema(e,h,h.parent,l);const m=s.default.isToken(h)?h.parent:h,g=null!==(t=m.symbol)&&void 0!==t?t:m.parent.symbol;if(!g)return o(a,l);let f=await this.schemaService.getSymbolSchemas(n,g);return!f.definition&&!f.property&&m.parent&&s.default.isVariableDeclaration(m.parent)&&m.parent.symbol&&(f=await this.schemaService.getSymbolSchemas(n,m.parent.symbol)),{value:f,dependencies:l,status:(0,r.getDefaultStatusHandling)(e,l)}}async computeArrayItemSchema(e,t,n,s){const i=n.elements.findIndex((e=>e===t)),c=n.parent.symbol;if(!c)return o(e.simpleAstNodeId,s);const l=await this.schemaService.getSymbolSchemas(e.filePath,c),d=l.property?(0,a.getArrayItemSchema)(l.property,i):void 0;return{value:{name:l.name,property:d,dependencies:[]},dependencies:s,status:(0,r.getDefaultStatusHandling)(e,s)}}async recompute(e,t,n,s){const{value:i}=await this.compute(e.getId());return{changes:[(0,r.fullChange)(i)],dependencies:s,status:(0,r.getDefaultStatusHandling)(e.getSerializedId(),s)}}}},13486:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaService=void 0;const s=n(26886),r=n(37894);function i(e,t,n,s){for(const i of e){const e=r.SchemaBuilder.getSchemaFromCacheEnv(i,t,n,s);if(e)return e}}t.SchemaService=class{constructor(e,t,n,s){var r;this.languageIntellisense=e,this.settings=s,this.cacheLoaded=new Promise(((e,t)=>{n.cacheUrl?n.fetchCache(n.cacheUrl).then((t=>{t&&(this.schemaCache=t),e()})).catch((()=>{t()})):e()})),this.schemaBuilders=new Map,(null===(r=this.settings)||void 0===r?void 0:r.followOtherFiles)&&console.warn("Setting followOtherFiles to true may result in performance and memory consumption overhead, use carefully")}changeSettings(e){this.settings={...this.settings,...e}}getModuleSchema(e){return this.getSchemaBuilder(e).getModuleSchema(e)}async getSymbolSchemas(e,t){if(await this.cacheLoaded,this.schemaCache){const n=`${e}#/definitions/${t.name}`,s=i(this.schemaCache,n,!1,!1),r=`${e}#/properties/${t.name}`,a=i(this.schemaCache,r,!1,!1);return{name:t.name,definition:s,property:a,dependencies:[]}}return this.getSchemaBuilder(e).getSchemas(e,t)}getTypeSchema(e,t,n=!1){return this.getSchemaBuilder(e).getTypeSchema(e,t,n)}getValueSchema(e,t,n=!1){return this.getSchemaBuilder(e).getValueSchema(e,t,n)}getSchemaForTsType(e,t){return this.getSchemaBuilder(e).getSchemaForTsType(e,t,!1,!0)}getSchemasForAllTsTypesAsBlob(e,t=!1,n=!1){if(!e.length)return null;const[{filePath:s}]=e;return this.getSchemaBuilder(s).getSchemasForAllTsTypesAsBlob(e,t,n)}async getSchemaByReference(e,t=!1,n=!1){if(await this.cacheLoaded,this.schemaCache)return{schema:i(this.schemaCache,e,t,!1),dependencies:[]};const[s]=e.split("#");return this.getSchemaBuilder(s).getSchemaByReference(e,t,n)}getSymbolSchemasByReference(e,t=!1){if((0,s.isEsTypeRef)(e))return;const[n]=e.split("#");return this.getSchemaBuilder(n).getSymbolSchemasByReference(e,t)}getSchemaBuilder(e){const t=this.languageIntellisense.getLanguageController(e,this);t.filePaths.has(e)||t.filePaths.add(e);const n=t.languageService,s=n.getProgram();if(!s)throw new Error(`Can't get a program for the file ${e}`);let i=this.schemaBuilders.get(n);return i||(i=new r.SchemaBuilder(s,this.settings),this.schemaBuilders.set(n,i)),s!==i.getProgram()&&i.setProgram(s),i}}},49262:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(5163);s.__exportStar(n(53661),t),s.__exportStar(n(93608),t)},93608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},53661:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getArrayItemSchema=t.getFileFromRef=t.getDefinitionFromRef=t.getTypeNameFromRef=t.getSimplifiedRef=void 0,t.getSimplifiedRef=e=>{const[t,n]=e.split("#"),s=n.lastIndexOf("/");return-1===s?`${t}#${n}`:`${t}#${n.substr(s+1)}`},t.getTypeNameFromRef=function(e){const t=e.split("#")[1].split("/");return t[t.length-1].replace("default.","")},t.getDefinitionFromRef=function(e){if(e.includes("#")&&e.split("#")[1].includes("/definitions/"))return e.split("#")[1].split("/definitions/")[1]},t.getFileFromRef=function(e){if(e.includes("#"))return e.split("#")[0]},t.getArrayItemSchema=function(e,t){const n=e.items;return Array.isArray(n)?n[t]:n}},48150:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const s=n(5163);s.__exportStar(n(17166),t);var r=n(17166);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.__importDefault(r).default}})},89111:(e,t,n)=>{e.exports=n(48150)}}]);