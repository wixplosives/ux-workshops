(self.webpackChunk_wixc3_component_playground=self.webpackChunk_wixc3_component_playground||[]).push([[973],{51272:(e,t,s)=>{"use strict";s.r(t),s.d(t,{classes:()=>r,cssStates:()=>i,keyframes:()=>a,namespace:()=>o,st:()=>d,stVars:()=>n,style:()=>c,vars:()=>l});const o="o325",r={root:"s1471",logItemIcon:"s975",logItemRoot:"s973",divider:"s982",tabBadge:"s981"},a={},n={},l={},i=s.stc.bind(null,o),c=s.sts.bind(null,o),d=c},64733:(e,t,s)=>{"use strict";s.r(t),s.d(t,{classes:()=>r,cssStates:()=>i,keyframes:()=>a,namespace:()=>o,st:()=>d,stVars:()=>n,style:()=>c,vars:()=>l});const o="o155",r={root:"s964",header:"s965",checkboxWithLabel:"s966",filter:"s967",filterText:"s968",logOptions:"s969",clearLog:"s970",preserveLog:"s971",list:"s972",logItemRoot:"s973",logItem:"s974",logItemIcon:"s975",logItemText:"s976",expandButtonContainer:"s977",logItemExpandButton:"s978",logItemExpandIcon:"s984",tabTitle:"s979",tabIcon:"s980",tabBadge:"s981",divider:"s982",headerDivider:"s983"},a={},n={},l={},i=s.stc.bind(null,o),c=s.sts.bind(null,o),d=c},50067:(e,t,s)=>{"use strict";s.r(t),s.d(t,{classes:()=>r,cssStates:()=>i,keyframes:()=>a,namespace:()=>o,st:()=>d,stVars:()=>n,style:()=>c,vars:()=>l});const o="o423",r={root:"s1777",secondaryCheckbox:"s1517",smallCheckbox:"s1518",checkedIcon:"s1774",indeterminateIcon:"s1775",tinyCheckbox:"s1776"},a={},n={},l={},i=s.stc.bind(null,o),c=s.sts.bind(null,o),d=c},83135:(e,t,s)=>{e.exports=s(77467)},84634:function(e,t,s){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(25199);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o(r).default}})},25199:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(93849),r=s(5689);t.default=new o.Feature({id:"platformCapabilities",dependencies:[],api:{dialogService:o.Service.withType().defineEntity(r.mainEnv),openUrlService:o.Service.withType().defineEntity(r.mainEnv),shellService:o.Service.withType().defineEntity(r.mainEnv),windowService:o.Service.withType().defineEntity(r.mainEnv)},context:{main:r.mainEnv.withContext()}})},75637:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPlatformServicesForBrowser=void 0,t.createPlatformServicesForBrowser=()=>({dialogService:{showOpenDialog:()=>{throw new Error("Not supported")},showOpenDialogSupported:()=>!1},openUrlService:{openUrl:(e,t="_blank",s)=>{window.open(e,t,s)}},shellService:{showItemInFolder:()=>{throw new Error("showItemInFolder() is not supported in browser")},showItemInFolderSupported:()=>!1},windowService:{focusWindow:()=>{throw new Error("focusWindow() is not supported in browser")},focusWindowSupported:()=>!1,maximizeWindow:()=>{throw new Error("maximizeWindow() is not supported in browser")},maximizeWindowSupported:()=>!1}})},78582:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(5163);o.__exportStar(s(20649),t),o.__exportStar(s(75637),t)},20649:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformServicesContext=t.setPlatformServicesContext=void 0,t.setPlatformServicesContext=function(e){t.PlatformServicesContext=e}},94078:(e,t,s)=>{e.exports=s(84634)},59506:(e,t,s)=>{e.exports=s(78582)},47784:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const o=s(5163);var r=s(23252);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.__importDefault(r).default}}),o.__exportStar(s(23252),t)},65502:(e,t,s)=>{e.exports=s(47784)},18413:(e,t,s)=>{e.exports=s(15701)},17996:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_ID=void 0;const o=s(5163),r=s(93849),a=o.__importDefault(s(65502)),n=o.__importDefault(s(4511)),l=o.__importDefault(s(94078)),i=s(84084),c=s(5689);t.LOG_ID="simulationLog";const d={checkedFilters:[i.CodeExecutionMessageType.consoleError,i.CodeExecutionMessageType.consoleWarn,i.CodeExecutionMessageType.consoleLog],preserveLog:!1};t.default=new r.Feature({id:"simulationLog",dependencies:[a.default.asEntity,n.default.asEntity,l.default.asEntity],api:{logConfig:new r.Config(d),simulationLogController:r.Service.withType().defineEntity(c.mainEnv)}})},53391:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(5163),r=o.__importStar(s(87363)),a=s(5689),n=o.__importStar(s(17996)),l=s(86312),i=s(69202),c=s(64733),d=s(84084),u=s(68724),g=s(18413),p=s(80820);n.default.setup(a.mainEnv,(({logConfig:e},{simulation:{drawerPanelSlot:t},simulationPreview:{consoleResourceManager:s}})=>{const o=new p.SimulationLogController(s,e.checkedFilters);return t.register({id:n.LOG_ID,label:()=>{const{simulation:{simulationData:{previewId:e}}}=(0,g.useSimulationTabContext)(),[t,o]=(0,r.useState)(0);return(0,r.useEffect)((()=>{if(e){const t=s.get(e);let r=t.createSnapshot();const a=()=>{const e=t.getChangesFromVersion(r);for(const t of e)if("add"===t.kind){const e=t.value;e.type===d.CodeExecutionMessageType.previewRenderStart?o(0):(0,l.filterMessages)([e],[d.CodeExecutionMessageType.consoleError]).length&&o((e=>e+1))}else"replace"===t.kind&&o(0);r=t.createSnapshot()};return t.subscribe(a),()=>{r.dispose(),t.unsubscribe(a)}}}),[e]),r.default.createElement(r.default.Fragment,null,r.default.createElement(i.DocumentSendSmallIcon,{className:c.classes.tabIcon}),r.default.createElement("div",{className:c.classes.tabTitle},"Log"),!!t&&r.default.createElement("div",{className:c.classes.tabBadge},t>99?"99+":t))},factory:()=>r.default.createElement(u.LogTabContainer,{simulationLogController:o})}),{simulationLogController:o}}))},31420:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogListItem=t.LogList=void 0;const o=s(5163).__importStar(s(87363)),r=s(69202),a=s(84084),n=s(59506),l=s(70268),i=s(38819),c=s(86312),d=s(64733);s(51272);const u=e=>o.default.createElement(t.LogListItem,{data:e.dataItem});t.LogList=(0,o.memo)((({messages:e})=>o.default.createElement("div",{className:d.classes.list},o.default.createElement(i.ListView,{renderItem:u},(0,i.createDataSource)(e,{idFunction:(e,t)=>t}))))),t.LogList.displayName="LogList";const g=e=>{switch(e){case a.CodeExecutionMessageType.consoleError:return"error";case a.CodeExecutionMessageType.consoleWarn:return"warn";case a.CodeExecutionMessageType.consoleInfo:return"info";case a.CodeExecutionMessageType.consoleLog:return"log";default:return""}};t.LogListItem=o.default.memo((({data:{type:e,message:t,divider:s}})=>{const[a,u]=(0,o.useState)(!1),p=(0,o.useCallback)((()=>u(!a)),[a]),{openUrlService:m}=(0,o.useContext)(n.PlatformServicesContext),f=(0,o.useCallback)((e=>{const t=e.key;"ArrowRight"===t?(u(!0),e.stopPropagation(),e.preventDefault()):"ArrowLeft"===t&&(u(!1),e.stopPropagation(),e.preventDefault())}),[]);if(s)return o.default.createElement("div",{className:d.classes.divider});if(!t)return null;const v=t.split("\n"),E=v.length>1,[y,...h]=v;return s?o.default.createElement("div",{className:d.classes.divider}):o.default.createElement(i.ListViewItemRoot,{className:(0,d.style)(d.classes.logItemRoot,{collapsed:E&&!a}),title:y,onKeyDown:f,onClick:a?void 0:p},o.default.createElement("div",{className:d.classes.logItem},o.default.createElement("div",{className:d.classes.expandButtonContainer},E?o.default.createElement("div",{className:d.classes.logItemExpandButton,onClick:p},a?o.default.createElement(r.ChevronDownIcon,{className:d.classes.logItemExpandIcon}):o.default.createElement(r.ChevronRightIcon,{className:d.classes.logItemExpandIcon})):null),o.default.createElement("div",{className:(0,d.style)(d.classes.logItemIcon,{type:g(e)})},(0,c.getDisplayNameForMessageType)(e)),o.default.createElement("div",{className:(0,d.style)(d.classes.logItemText,{expand:a})},o.default.createElement(l.Linkify,{text:y,renderLink:(e,t)=>o.default.createElement("a",{key:t,href:e,onClick:t=>{t.stopPropagation(),t.preventDefault(),m.openUrl(e)}},e)}),a&&h.length>0&&o.default.createElement("div",null,h.join("\n")))))})),t.LogListItem.displayName="LogListItem"},68724:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogTabContainer=void 0;const o=s(5163).__importStar(s(87363)),r=s(83135),a=s(18413),n=s(86312);t.LogTabContainer=(0,o.memo)((function({simulationLogController:e}){const{simulation:t}=(0,a.useSimulationTabContext)(),{previewId:s}=t.simulationData,[l,i]=(0,o.useState)(e.getInitialState()),{track:c}=(0,o.useContext)(r.AnalyticsContext);return(0,o.useEffect)((()=>{if(s)return e.subscribe(s,i),()=>{e.unsubscribe(s,i)}}),[e,s]),o.default.createElement(n.LogTab,{messages:l.messages,onClearLog:()=>{s&&(e.clear(s),c("clicked 'clear log'"))},preserveLog:l.preserveLog,onTogglePreserveLog:()=>{const t=!l.preserveLog;s&&(e.setPreserveLog(s,t),c(t?"checked 'preserve log'":"unchecked 'preserve log'"))},filters:l.filters,onToggleFilter:t=>{s&&(e.toggleFilter(s,t),c(`toggled ${t} filter`))}})}))},86312:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogTab=t.filterMessages=t.getDisplayNameForMessageType=void 0;const o=s(5163).__importStar(s(87363)),r=s(84084),a=s(69202),n=s(70268),l=s(50067),i=s(64733),c=s(31420);function d(e){switch(e){case r.CodeExecutionMessageType.consoleLog:return"log";case r.CodeExecutionMessageType.consoleError:return"error";case r.CodeExecutionMessageType.consoleInfo:return"info";case r.CodeExecutionMessageType.consoleWarn:return"warn";case r.CodeExecutionMessageType.previewRenderStart:return"render start"}}s(51272),t.getDisplayNameForMessageType=d;const u=[{id:r.CodeExecutionMessageType.consoleError,title:d(r.CodeExecutionMessageType.consoleError)},{id:r.CodeExecutionMessageType.consoleWarn,title:d(r.CodeExecutionMessageType.consoleWarn)},{id:r.CodeExecutionMessageType.consoleLog,title:d(r.CodeExecutionMessageType.consoleLog)},{id:r.CodeExecutionMessageType.consoleInfo,title:d(r.CodeExecutionMessageType.consoleInfo)}],g=["[HMR]","[WDS]",'{"_suppressLogging":true}'];function p(e,t){return e.filter((({message:e,divider:s,type:o})=>!!s||!(!e||!t.includes(o))&&!g.find((t=>e.startsWith(t)))))}t.filterMessages=p;const m=(0,o.memo)((({filters:e,toggleFilters:t,togglePreserveLog:s,preserveLog:r,clearLog:c})=>o.default.createElement("div",{className:i.classes.header},o.default.createElement("div",{className:i.classes.filterText},"Filter"),u.map((s=>o.default.createElement("label",{key:s.id,className:i.classes.checkboxWithLabel+" "+i.classes.filter,"data-filter":s.title},o.default.createElement(n.Checkbox,{className:l.classes.secondaryCheckbox,checked:e.includes(s.id),onChange:()=>t(s.id)}),s.title))),o.default.createElement("div",{className:i.classes.logOptions},o.default.createElement(n.Tooltip,{content:"Clear Log"},o.default.createElement(n.IconButton,{className:i.classes.clearLog,onClick:c},o.default.createElement(a.BlockIcon,null))),o.default.createElement("div",{className:i.classes.headerDivider}),o.default.createElement("label",{className:i.classes.checkboxWithLabel+" "+i.classes.preserveLog},o.default.createElement(n.Checkbox,{className:l.classes.secondaryCheckbox,checked:r,onChange:s}),"preserve log")))));m.displayName="Header",t.LogTab=(0,o.memo)((({messages:e,filters:t,onTogglePreserveLog:s,onClearLog:r,preserveLog:a,onToggleFilter:n})=>o.default.createElement("div",{className:i.classes.root},o.default.createElement(m,{filters:t,toggleFilters:n,togglePreserveLog:s,preserveLog:a,clearLog:r}),o.default.createElement(c.LogList,{messages:p(e,t)})))),t.LogTab.displayName="LogTab"},80820:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulationLogController=void 0;const o=s(84084);t.SimulationLogController=class{constructor(e,t){this.consoleResourceManager=e,this.defaultFilters=t,this.logsByPreviewId=new Map}showMessage(e,t,s){var o;const r=this.logsByPreviewId.get(e);if(!r)return;const{state:a,resource:n}=r;a.messages.find((e=>e.type===t&&e.message===s))||n.sendMessage(t,s),(null===(o=a.filters)||void 0===o?void 0:o.includes(t))||this.toggleFilter(e,t)}toggleFilter(e,t){var s;const o=null===(s=this.logsByPreviewId.get(e))||void 0===s?void 0:s.state.filters;if(!o)return;let r;r=o.includes(t)?o.filter((e=>e!==t)):[...o,t],this.setState(e,{filters:r})}setPreserveLog(e,t){this.setState(e,{preserveLog:t})}subscribe(e,t){const s=this.logsByPreviewId.get(e);if(s)return void s.subscribers.add(t);const o={},r=this.consoleResourceManager.get(e,o),a=()=>this.handleNewMessage(e,r),n={...this.getInitialState(),messages:r.getLatest().messages};this.logsByPreviewId.set(e,{subscribers:new Set([t]),state:n,resource:r,resourceSnapshot:r.createSnapshot(),dispose:()=>{const t=this.logsByPreviewId.get(e);null==t||t.resourceSnapshot.dispose(),r.unsubscribe(a),r.release(o),this.logsByPreviewId.delete(e)}}),r.subscribe(a)}unsubscribe(e,t){const s=this.logsByPreviewId.get(e);if(!s)return;const{subscribers:o,dispose:r}=s;o.delete(t),0===o.size&&r()}getInitialState(){return{filters:this.defaultFilters,preserveLog:!1,messages:[]}}clear(e){const t=this.logsByPreviewId.get(e);t&&(this.setState(e,{messages:[]}),t.resource.clear())}handleNewMessage(e,t){const s=this.logsByPreviewId.get(e);if(!s)return;const{state:r,resourceSnapshot:a}=s,n=t.getChangesFromVersion(a);let l=[...r.messages];for(const e of n)if("add"===e.kind){const t=e.value;if(t.type===o.CodeExecutionMessageType.previewRenderStart){const e={type:o.CodeExecutionMessageType.consoleLog,message:"",divider:!0};l=r.preserveLog?[...l,e]:[]}l.push(t)}this.setState(e,{messages:l}),s.resourceSnapshot=t.createSnapshot()}setState(e,t){const s=this.logsByPreviewId.get(e);if(s){const e={...s.state,...t};s.state=e,s.subscribers.forEach((e=>e(s.state)))}}}},80673:(e,t)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.ENVIRONMENT_PROPERTIES_KEYS=t.CodeExecutionMessageType=t.SIMULATION_CANVAS_CLASS_NAME=void 0,t.SIMULATION_CANVAS_CLASS_NAME="simulationCanvas",(s=t.CodeExecutionMessageType||(t.CodeExecutionMessageType={}))[s.consoleError=0]="consoleError",s[s.consoleWarn=1]="consoleWarn",s[s.consoleLog=2]="consoleLog",s[s.consoleInfo=3]="consoleInfo",s[s.previewRenderStart=4]="previewRenderStart",t.ENVIRONMENT_PROPERTIES_KEYS=["windowHeight","windowWidth","windowBackgroundColor","canvasHeight","canvasWidth","canvasBackgroundColor","canvasMargin","canvasPadding"]},91832:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(5163);o.__exportStar(s(31705),t),o.__exportStar(s(80673),t)},31705:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},84084:(e,t,s)=>{e.exports=s(91832)}}]);