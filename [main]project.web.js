(self.webpackChunk_wixc3_component_playground=self.webpackChunk_wixc3_component_playground||[]).push([[7042],{81693:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(5163),n=i.__importDefault(r(87363)),s=r(93849),o=r(60814),a=r(5689),c=r(70268),d=r(69202),l=i.__importStar(r(31434)),u=r(98180),h=r(45450),p=r(18012),f=r(71299),y="server-disconnected";l.default.setup(a.mainEnv,(({fileManager:e,directoryManager:t,fileListManager:r,projectService:i,pluggableProjectConfig:a,undoRedoStateManager:v,run:g},{COM:m,gui:{overlayPanelFactory:E,panelStore:D},analytics:{analyticsService:P}},{mainContext:{serverEnvironmentInitializer:_}})=>{const M=a.consume({});m.communication.isServer=!1;const F={worker:s.workerInitializer,"live-server":_},S=(0,s.initializeContextualEnv)({communication:m.communication,env:l.processingEnv,envInitializers:F});E.register({id:y,factory:()=>n.default.createElement(c.Notification,{curtain:!0,icon:d.BlockIcon,title:h.errors.serverDisconnectedTitle},h.errors.serverDisconnectedContent)});const C={id:y,options:{placement:"bottom-start",strategy:"fixed"},panelType:y};S.then((({onDisconnect:e,onReconnect:t})=>{e&&e((()=>{P.track("server disconnected"),D.openOverlay(C)})),t&&t((()=>{D.closePanel(C.id)}))})).catch(s.reportError);const R=e.consume({resourceConstructor:f.FileResource,manipulator:o.stringManipulator}),T=t.consume({manipulator:u.directoryManipulator}),L=r.consume({}),j=v.consume({});let O="";return g((async()=>{O=await i.getProjectPath()})),{fileManagerMain:R,directoryManagerMain:T,fileListManagerMain:L,pluggableProjectConfigMain:M,undoRedoStateManagerMain:j,getRelativePathInProject:e=>(0,p.removePrefixPath)(O,e),getProjectPath:()=>O}}))},45450:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors=void 0,t.errors={serverDisconnectedTitle:"Server Not Connected",serverDisconnectedContent:"Check that the project is still running, or try refreshing the browser."}},98180:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.directoryManipulator=t.directoryReducer=t.DirectoryChangeKind=void 0,function(e){e.FULL="full",e.ADD="add",e.REMOVE="remove"}(r=t.DirectoryChangeKind||(t.DirectoryChangeKind={})),t.directoryReducer=(e,t)=>{switch(t.kind){case r.FULL:return{value:t.value,invertingChanges:[{kind:r.FULL,value:e}]};case r.ADD:return{value:[...e,t.node],invertingChanges:[{kind:r.FULL,value:e}]};case r.REMOVE:return{value:e.filter((e=>e.name!==t.name)),invertingChanges:[{kind:r.FULL,value:e}]};default:return{value:e,invertingChanges:[{kind:r.FULL,value:e}]}}},t.directoryManipulator={reducer:t.directoryReducer}},71299:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileResource=void 0;const i=r(60814),n=r(78204);class s extends i.Resource{delete(){this.invalidate(n.FILE_RESOURCE_DELETE_MESSAGE)}restoreDeleted(){this.setStatus({valid:!0})}isDeleted(){return!this.isValid()&&this.getInvalidationMessage()===n.FILE_RESOURCE_DELETE_MESSAGE}}t.FileResource=s},61276:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileScannerComputeHandler=t.getDirectoryEntities=t.traverseFs=void 0;const i=r(93849),n=r(98180);t.traverseFs=function e({directoryPath:t,fs:r,filterFile:n=i.returnsTrue,filterDirectory:s=i.returnsTrue,directories:o=[],files:a=[]}){const{readdirSync:c}=r;o.push({path:t,name:r.basename(t)});for(const i of c(t,{withFileTypes:!0})){const c=i.name,d=r.join(t,c);i.isDirectory()&&s(d,c)?e({directoryPath:d,fs:r,filterFile:n,filterDirectory:s,directories:o,files:a}):i.isFile()&&n(d,c)&&a.push({path:d,name:c})}return{directories:o,files:a}},t.getDirectoryEntities=function({directoryPath:e,fs:t}){const{readdirSync:r}=t,i={directories:[],files:[]};for(const n of r(e,{withFileTypes:!0})){const r=n.name,s=t.join(e,r);n.isDirectory()?i.directories.push({path:s,name:r}):n.isFile()&&i.files.push({path:s,name:r})}return i},t.FileScannerComputeHandler=class{constructor(e,t,r,i,n){this.controller=e,this.manipulator=t,this.fs=r,this.pathPredicate=i,this.directoryManager=n}compute(e){let t=this.controller.getEmptyValue();const{changes:r,dependencies:i}=this.addDirectory(e,t);for(const e of r)t=this.manipulator.reducer(t,e).value;return{value:t,dependencies:i,status:{valid:!0}}}recompute(e,t,r,i){const n=e.getLatest(),s=[];let o=new Set(i);for(const e of r){if(!e.isValid())continue;const r=e.getType(),{changes:i,dependencies:a}=this.getDirectoryRelatedUpdates(e,t[r][e.getSerializedId()],n,o);s.push(...i),o=a}const a=Array.from(i).filter((e=>!e.isValid()));return{dependencies:new Set([...o].filter((e=>!a.includes(e)))),changes:s,status:{valid:!0}}}addDirectory(e,t){const r=new Set,{files:i,directoryResources:n}=this.addDirRecurse(e),s=[],o=this.controller.onFilesAdded(t,i.map((({path:e})=>e)));return n.forEach((e=>r.add(e))),s.push(...o.changes),{changes:s,dependencies:r}}addDirRecurse(e,t=[],r=[],i=[]){const n=this.directoryManager.get(e);i.push(n);const s=n.getLatest();for(const n of s){const s={name:n.name,path:this.fs.join(e,n.name)};this.pathPredicate(s.path)&&(n.stats.isDirectory?(t.push(s),this.addDirRecurse(s.path,t,r,i)):n.stats.isFile&&this.controller.predicate(s.path)&&r.push(s))}return{files:r,directories:t,directoryResources:i}}getDirectoryRelatedUpdates(e,t,r,i){if(t.isDisposed())return{changes:[],dependencies:i};const s=[],o=new Set(i),a=e.getChangesFromVersion(t),c=e.getId();return a.forEach((e=>{if(e.kind===n.DirectoryChangeKind.ADD){const t=this.fs.join(c,e.node.name);if(e.node.stats.isDirectory){if(this.pathPredicate(t)){const{changes:e,dependencies:i}=this.addDirectory(t,r);for(const e of i)o.add(e);s.push(...e)}}else if(this.pathPredicate(t)&&this.controller.predicate(t)){const{changes:e}=this.controller.onFilesAdded(r,[t]);s.push(...e)}}else if(e.kind===n.DirectoryChangeKind.REMOVE){const t=this.fs.join(c,e.name);s.push(...this.controller.onRemoved(r,t))}})),{changes:s,dependencies:o}}}},33506:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removePrefixPath=t.createPathPredicate=t.directoryDeepChildren=t.getPathsOfFilePath=t.getTreeNodePath=void 0;const i=r(71876),n=r(73654),s=r(91570);function o(e,t){return e.split(t).filter((e=>!!e))}function a(){return!0}t.getTreeNodePath=o,t.getPathsOfFilePath=function(e,t){var r;const i=e?o(e,t):[],n=[];for(let e=0;e<i.length;e++)n.push((null!==(r=n[e-1])&&void 0!==r?r:"")+t+i[e]);return n},t.directoryDeepChildren=async function*e(t,r,i=a,n=r){for(const s of await t.promises.readdir(r,{withFileTypes:!0})){const o=s.name,a=t.join(r,o),c=t.relative(n,a);if(s.isFile()){const e={type:"file",path:a,name:o,relativePath:c};i(e)&&(yield e)}else if(s.isDirectory()){const r={type:"directory",path:a,name:o,relativePath:c};i(r)&&(yield r,yield*e(t,a,i,n))}}},t.createPathPredicate=function(e,t,r){const n=r.map((e=>(0,i.makeRe)(e)));return r=>{const i=e.relative(t,r);return!n.some((e=>e.test(i)))}},t.removePrefixPath=(e,t)=>e?(0,s.replaceWinSlashes)(n.win32.relative(e,t)):(0,s.replaceWinSlashes)(t)},18012:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(5163);i.__exportStar(r(78204),t),i.__exportStar(r(98180),t),i.__exportStar(r(33506),t),i.__exportStar(r(98073),t),i.__exportStar(r(61276),t)},98073:(e,t)=>{"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.NodeType=t.FsEventType=void 0,(i=t.FsEventType||(t.FsEventType={}))[i.CREATE=0]="CREATE",i[i.LOAD=1]="LOAD",i[i.UPDATE=2]="UPDATE",i[i.DELETE=3]="DELETE",(r=t.NodeType||(t.NodeType={}))[r.directory=0]="directory",r[r.file=1]="file",r[r.virtual=2]="virtual",r[r.none=3]="none"},60814:(e,t,r)=>{e.exports=r(73858)}}]);